= git rebase æ™‚ã« "cannot lock ref 'HEAD'" ã‚¨ãƒ©ãƒ¼
akiakiS
v1.1, 2020-10-05
:created_at: 2020-08-01
:tags: git
:toc: left
:toc-title: ç›®æ¬¡
:toclevels: 3
include::commons/attrs.adoc[tags=images;admonitions]

== ğŸ’£ å•é¡Œ

_fixup_ ã‚„ _squash_ ãªã‚³ãƒŸãƒƒãƒˆã‚’ã¾ã¨ã‚ã‚ˆã†ã¨ `git rebase` ã—ãŸã¨ãã«ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿã€‚

.Error!
[source,shell]
----
$ git rebase -i â€“autosquash develop

fatal: cannot lock ref 'HEAD': is at 5b41137 but expected c3b1c26
Could not apply c3b1c26â€¦ COMMIT_MESSAGE
----

ãƒ–ãƒ©ãƒ³ãƒã®ãƒ„ãƒªãƒ¼ã¯æ¬¡ã®ã‚ˆã†ãªçŠ¶æ…‹ã€‚

.ãƒ–ãƒ©ãƒ³ãƒãƒ„ãƒªãƒ¼ä¾‹
image::codepen/example.png[Git Graph]

## ğŸ” åŸå› ï¼ˆãŸã¶ã‚“ï¼‰

ãªã‚“ã‹ `.git/refs/heads/` ç›´ä¸‹ã«ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã€‚
ï¼ˆä¾‹ã§ã¯ `akiakishitai/` ï¼‰

..git/refs/heads/ ä»¥ä¸‹ã‚’æ¢ç´¢
[source,shell,options="data-user"]
----
$ ls .git/refs/heads/
akiakishitai/  master

$ ls -Al .git/refs/heads/akiakishitai/
total 0
----

ã“ã®ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒ `HEAD` ã‚’å‚ç…§ã™ã‚‹ã¨ãã«ä½¿ã‚ã‚Œã¦ã€ã§ã‚‚ç©ºãªã®ã§ä»£ã‚ã‚Šã« `master` ã®æ–¹ãŒä½¿ã‚ã‚Œã‚‹ã€ã®ã‹ãªãï¼Ÿ

== ğŸ’ª è§£æ±º

ã¨ã‚Šã‚ãˆãšä¸Šè¨˜ã®ä¸å¿…è¦ãªç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰å†åº¦ `git rebase` å®Ÿè¡Œã€‚

.ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤ã§æˆåŠŸ
[source,shell]
----
$ rmdir .git/refs/heads/akiakishitai/
$ git rebase -i â€“autosquash develop

[detached HEAD 15204bc] ...
...
 3 files changed, 24 insertions(+), 7deletions(-)
Successfully rebased and updated refs/heads/akiakishitai/issue123.
----

ç„¡äº‹æˆåŠŸï¼ğŸ‘
