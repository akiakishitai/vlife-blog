{"filename":"cli_yt-dlp.adoc","rendered":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">目次</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_はじめに\">🍈はじめに</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_使用前の注意事項\">使用前の注意事項</a></li>\n</ul>\n</li>\n<li><a href=\"#_インストール\">🚀インストール</a></li>\n<li><a href=\"#_使い方\">🎙️使い方</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_シミュレーションテスト\">シミュレーション・テスト</a></li>\n<li><a href=\"#_情報取得\">情報取得</a></li>\n<li><a href=\"#_ダウンロードする\">ダウンロードする</a>\n<ul class=\"sectlevel3\">\n<li><a href=\"#_フォーマット指定について\">フォーマット指定について</a></li>\n</ul>\n</li>\n<li><a href=\"#_post_processing\">Post Processing</a></li>\n</ul>\n</li>\n<li><a href=\"#_高度な機能\">🔬高度な機能</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#output-template\">Output Template</a></li>\n<li><a href=\"#_メタデータの変更\">メタデータの変更</a></li>\n</ul>\n</li>\n<li><a href=\"#_設定ファイル\">⚙️設定ファイル</a></li>\n<li><a href=\"#_トラブルシューティング\">🛠️トラブルシューティング</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_output_template_周りのエラー\"><em>Output Template</em> 周りのエラー</a></li>\n<li><a href=\"#_python_no_such_file_or_directory\">‘python’: No such file or directory</a></li>\n</ul>\n</li>\n<li><a href=\"#_参考\">📖参考</a></li>\n</ul>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_はじめに\">🍈はじめに</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>ひさしぶりに <code>youtube-dl (2021.06.06)</code> を使ったらダウンロード速度が 80KB/s 程度ですごく遅い。<br>\nネット環境のせいかと思ったらそうでもないらしい。<br>\n<a href=\"https://github.com/ytdl-org/youtube-dl/issues/30097\" target=\"_blank\" rel=\"noopener\">この <em>GitHub Issue</em></a> によると、修正されるまでは <code>youtube-dl</code> フォークの <code>yt-dlp</code> を使ったほうがいいみたい。</p>\n</div>\n<div class=\"paragraph\">\n<p>なので <code>yt-dlp</code> をインストールして使ってみる。</p>\n</div>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<caption class=\"title\">Table 1. 環境</caption>\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">App</th>\n<th class=\"tableblock halign-left valign-top\">Version</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><strong>Debian</strong></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><em>10 (WSL)</em></p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><strong>yt-dlp</strong></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><em>2021.12.01</em></p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\" data-md-icon=\"report\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">Pythonツールについて</div>\n<em>Windows</em> のパスや文字エンコード、コマンドプロンプトと相性が悪い。<br>\nよって <em>Windows</em> 環境ではなく、 <em>WSL</em> の中でインストールするのがいい。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_使用前の注意事項\">使用前の注意事項</h3>\n<div class=\"admonitionblock warning\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-warning\" title=\"Warning\" data-md-icon=\"warning\"></i>\n</td>\n<td class=\"content\">\n違法ダウンロードや著作権侵害など、法に触れないよう気をつけてください。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock warning\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-warning\" title=\"Warning\" data-md-icon=\"warning\"></i>\n</td>\n<td class=\"content\">\n推しの動画は <em>Youtube</em> などの動画プラットフォーム上で再生するのが一番いい。<br>\n再生数や広告収入を増やしたり、コメントつけたりして応援しようね！\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_インストール\">🚀インストール</h2>\n<div class=\"sectionbody\">\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<em>WSL</em> 環境下でインストールしている。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 1. yt-dlp インストール</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">バイナリをダウンロード</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"7-8\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">cd /usr/local/bin\nsudo curl \\\n    -SsLO https://github.com/yt-dlp/yt-dlp/releases/download/2021.12.01/yt-dlp\ncurl -SsL https://github.com/yt-dlp/yt-dlp/releases/download/2021.12.01/SHA2-256SUMS \\\n    | grep 'yt-dlp$' \\\n    | sha256sum --check\nyt-dlp: OK\n\nsudo chmod a+rx yt-dlp</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">バージョン確認</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --version\n2021.12.01</code></pre>\n  </div>\n</div>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>また、推奨オプションである <code>ffmpeg</code> もインストールしておく。</p>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 2. ffmpeg インストール</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">sudo apt update\nsudo apt install ffmpeg</code></pre>\n  </div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_使い方\">🎙️使い方</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>ダウンロードしたり情報取得したりする方法は、ほぼ <code>youtube-dl</code> と同じ。<br>\nただし、<a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#deprecated-options\" target=\"_blank\" rel=\"noopener\">いくつかのオプションは廃止予定または非推奨</a>になっている。</p>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 3. 基本</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">動画ダウンロード</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp https://&lt;VIDEO_URL&gt;</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">ダウンロード先ディレクトリを指定</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --paths '/path/to/download/dir' https://&lt;VIDEO_URL&gt;</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">動画のメタデータを利用してファイルパスを指定</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --output '~/video/%(artist)s/%(title)s.%(ext)s' https://&lt;VIDEO_URL&gt;</code></pre>\n  </div>\n</div>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>以下、よく使いそうなオプションを抜粋。</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_シミュレーションテスト\">シミュレーション・テスト</h3>\n<div class=\"paragraph\">\n<p>設定を確認するときによく使うオプション。</p>\n</div>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">Option</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--simulate</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画のダウンロードはせず、他すべての書き込みもしない。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--skip-download</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画のダウンロードはしない。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--verbose</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">実行時の詳細情報を表示する。<br>\n設定変更やエラー発生時の確認に利用する。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_情報取得\">情報取得</h3>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 27.2727%;\">\n<col style=\"width: 72.7273%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">Option</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--print &lt;TEMPLATE&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><a href=\"#output-template\"><em>Output Template</em></a> の各フィールド名または書式を利用して動画の情報を表示する。<br>\n複数回の指定可能。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--list-formats</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">指定可能なフォーマットの一覧を表示する。</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n上記オプションを利用すると、自動的に <code>--simulate</code> モードとみなされる。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 4. --print の使用例</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">動画タイトル</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-3,5\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --print title https://www.youtube.com/watch?v=S8dmq5YIUoc\nKizuna AI - AIAIAI (feat. 中田ヤスタカ)【Official Music Video】\n\nyt-dlp --print track https://www.youtube.com/watch?v=S8dmq5YIUoc\nAIAIAI (feat. 中田ヤスタカ)</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">作者名</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --print '%(artist,creator,uploader)s' https://www.youtube.com/watch?v=S8dmq5YIUoc\nKizuna AI (キズナアイ)</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">チャンネル名</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --print channel https://www.youtube.com/watch?v=S8dmq5YIUoc\nA.I.Channel</code></pre>\n  </div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_ダウンロードする\">ダウンロードする</h3>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">Option</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--paths &lt;[TYPES:]PATH&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">ダウンロード先のパスを指定する。<br>\n<em>TYPES</em> では <code>temp</code> を指定して一時ダウンロード先を指定できる。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--output &lt;[TYPES:]TEMPLATE&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">出力ファイルパスを指定する。<br>\n<a href=\"#output-template\"><em>Output Template</em></a> 構文を利用できる。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--format &lt;FORMAT&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#format-selection\" target=\"_blank\" rel=\"noopener\">動画フォーマット</a>を指定する。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--write-thumbnail</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">サムネイル画像を一緒にダウンロードする。<br>\n<code>--skip-download</code> オプションを同時指定すると、<br>\nサムネイルのみダウンロードできる。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--embed-metadata</code><br>\n<em>or</em> <code>--add-metadata</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画ファイルにメタデータを埋め込む。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--batch-file &lt;FILE&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">１行ごとに <em>URL</em> を列挙したファイルを読み込み、それぞれダウンロードする。<br>\nハイフン（<code>-</code>）を指定すると標準入力から読み込む。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--datebefore DATE</code> ,<br>\n<code>--dateafter DATE</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画投稿日の以前/以降でフィルタリングする。<br>\n書式は <code>YYYYMMDD</code> または<br>\n<code>(now|today)[+-][0-9](day|week|month|year)(s)?</code></p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">ダウンロードURL</div>\nプレイリストの <em>URL</em> を指定すれば、各動画をそれぞれダウンロードできる。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">--paths と --output</div>\n<div class=\"paragraph\">\n<p>次のような使い分けをすればいいと思う。</p>\n</div>\n<div class=\"dlist\">\n<dl>\n<dt class=\"hdlist1\"><code>--paths</code></dt>\n<dd>\n<p>ダウンロード先のベースディレクトリ（<code>~/MyVideo</code> とか）を指定。</p>\n</dd>\n<dt class=\"hdlist1\"><code>--output</code></dt>\n<dd>\n<p>各動画によって異なる情報（タイトルとか投稿日とか）を用いるディレクトリ・ファイルパスを指定。</p>\n</dd>\n</dl>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 5. ダウンロード実行例</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">ダウンロードしたファイル名に動画タイトルと投稿日を利用</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --output '%(title)s_%(upload_date)s.%(ext)s' $VIDEO_URL</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">プレイリストにある各動画をダウンロード</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"4-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp \\\n    --output '%(uploader)s/%(title)s.%(ext)s' \\\n    https://www.youtube.com/playlist?list=PL0bHKk6wuUGLWGipKSf0dFrpuzDitERqD</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">日付でフィルタリング</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"5-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp \\    <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\n    --dateafter '20200101' \\\n    --datebefore '20200601' \\\n    https://www.youtube.com/playlist?list=PL0bHKk6wuUGLWGipKSf0dFrpuzDitERqD</code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td><em>2020/01/01</em> ～ <em>2020/06/01</em> までに投稿された動画をダウンロードする。</td>\n</tr>\n</table>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">高画質な動画に設定し、投稿者ごとにフォルダ分けする</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp \\\n    --format best \\    <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\n    --output '%(uploader)s/%(title)s.%(ext)s' \\     <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\n    $VIDEO_URL</code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>フォーマットで高画質な動画（音声含む）に設定。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td><code>&lt;投稿者&gt;/&lt;タイトル&gt;.&lt;拡張子&gt;</code> ファイルとして出力する。</td>\n</tr>\n</table>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">URLリストを読み込んでそれぞれダウンロード</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-3,5-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --batch-file download.list\n\n# Specify the line range (1-10 lines)\nsed --quiet '1, 10p' download.list | yt-dlp --batch-file -</code></pre>\n  </div>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_フォーマット指定について\">フォーマット指定について</h4>\n<div class=\"paragraph\">\n<p>よく使いそうなものを一部抜粋。<br>\n詳細は <a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#format-selection\" target=\"_blank\" rel=\"noopener\">README#Format Selection</a> を参照。<br>\nまた、フィルタリングについては <a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#filtering-formats\" target=\"_blank\" rel=\"noopener\">README#Filtering Formats</a> を参照。</p>\n</div>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<caption class=\"title\">Table 2. フォーマット指定の例</caption>\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">Format</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>bestvideo*+bestaudio/best</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">最高品質の動画と音声をそれぞれダウンロードした後にマージする<sup class=\"footnote\" id=\"_footnote_ffmpeg\">[<a id=\"_footnoteref_1\" class=\"footnote\" href=\"#_footnotedef_1\" title=\"View footnote.\">1</a>]</sup>。<br>\n最高品質の動画がない場合、高画質な音声あり動画（<code>best</code>）をダウンロードする。<br>\n（デフォルト値）</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>bestvideo*</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">最高品質の動画をダウンロード。音声が含まれる場合もある<sup class=\"footnote\">[<a id=\"_footnoteref_2\" class=\"footnote\" href=\"#_footnotedef_2\" title=\"View footnote.\">2</a>]</sup>。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>bestaudio</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">最高品質の<strong>音声のみ</strong>をダウンロード。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>best</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">音声ありの動画の中で高画質なものをダウンロードする。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-middle\"><p class=\"tableblock\"><em>ID 番号</em></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>yt-dlp --list-formats</code> で確認できるフォーマットの <em>ID</em> 番号を直接指定できる。</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n最高品質のものは動画と音声が別れている。\n</td>\n</tr>\n</table>\n</div>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<caption class=\"title\">Table 3. フォーマット指定で使える演算子</caption>\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-center valign-top\">Operator</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>/</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">フォーマットの優先順位をつける。<br>\n左側に指定したフォーマットほど優先度が高い。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>,</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">同じ動画で複数のフォーマットをダウンロードしたいときに使う。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>+</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画と音声のフォーマットを個別に指定して、<br>\nダウンロード後にマージさせる<sup class=\"footnoteref\">[<a class=\"footnote\" href=\"#_footnotedef_1\" title=\"View footnote.\">1</a>]</sup>。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_post_processing\">Post Processing</h3>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">Option</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--merge-output-format &lt;FORMAT&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画と音声を<strong>マージするとき</strong>のコンテナフォーマットを指定する（<code>mkv</code>, <code>mp4</code>, <code>ogg</code>, <code>webm</code>, <code>flv</code>）。<br>\nもちろん、マージする必要がなければ無効。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--remux-video &lt;FORMAT&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画を別のコンテナフォーマットに変換する。<br>\n（<code>mp4</code>, <code>mkv</code>, <code>webm</code>, <code>avi</code>, <code>mp3</code>, <code>opus</code>, etc&#8230;&#8203;）</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>--exec &lt;COMMAND&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>yt-dlp</code> による処理完了後に実行するコマンドを指定する。<br>\n引数として <a href=\"#output-template\"><em>Output Template</em></a> 構文を利用できる。<br>\n（複数回の指定・実行が可能）</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_高度な機能\">🔬高度な機能</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><em>Output Template</em> とメタデータの変更方法について説明。</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"output-template\"><a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#output-template\" target=\"_blank\" rel=\"noopener\">Output Template</a></h3>\n<div class=\"paragraph\">\n<p><code>--output</code> や <code>--exec</code> オプションで利用できるテンプレート。<br>\n動画のタイトルやチャンネル名などを取得してファイルパスに利用することができる。</p>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p><code>yt-dlp</code> では <em>Output Template</em> が強化されており、フォーマットの指定が便利になっている。<br>\n詳しくは <a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#output-template\" target=\"_blank\" rel=\"noopener\">README</a> を参照。</p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>基本の書式は <code>%(FIELD_NAME)FORMAT_TYPE</code> となる。</p>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 6. Output Template サンプル</div>\n<div class=\"content\">\n<div \n    class=\"listingblock\">\n<div class=\"title\">https://www.youtube.com/watch?v=BaW_jenozKc の場合の例</div>\n  <div class=\"content\">\n  <pre class=\"highlight \" ><code class=\"language-python\"\n    data-lang=\"python\">'%(title)s.%(ext)s'         # -&gt; youtube-dl test video \"'/\\ä↭𝕐.webm\n'%(upload_date&gt;%Y-%m-%d)s'  # -&gt; 2012-10-02\n'%(creator)s'               # -&gt; NA  (欠損値)\n'%(uploader)s'              # -&gt; Philipp Hagemeister\n'%(creator,uploader)s'      # -&gt; Philipp Hagemeister\n\n# Compare by format type\n'%(channel)<span class=\"text-red-500\">s</span>'      # -&gt; Philipp Hagemeister\n'%(channel)<span class=\"text-red-500\">j</span>'      # -&gt; \"Philipp Hagemeister\"\n'%(channel)<span class=\"text-red-500\">q</span>'      # -&gt; 'Philipp Hagemeister'\n'%(tags)<span class=\"text-red-500\">s</span>'         # -&gt; ['youtube-dl']\n'%(tags)<span class=\"text-red-500\">j</span>'         # -&gt; [\"youtube-dl\"]\n'%(tags)<span class=\"text-red-500\">q</span>'         # -&gt; '['\"'\"'youtube-dl'\"'\"']'</code></pre>\n  </div>\n</div>\n</div>\n</div>\n<hr>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<caption class=\"title\">Table 4. フィールド（一部抜粋）</caption>\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">Variable</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>title</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画のタイトル</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>creator</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画の作者名</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>channel</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画をアップロードしたチャンネル名</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>ext</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">動画ファイル拡張子</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>upload_date</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">アップロード日（<em>YYYYMMDD</em>）</p></td>\n</tr>\n</tbody>\n</table>\n<table id=\"output-template_format-type\" class=\"tableblock frame-all grid-all fit-content\">\n<caption class=\"title\">Table 5. フォーマット型（一部抜粋）</caption>\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-center valign-top\">Type</th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>s</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">文字列として変換。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>d</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">符号付き整数（10進法）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>f</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">浮動小数点数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>j</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><em>JSON</em> 形式の値に変換。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>q</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">必要ならシェルのためにクォーテーションがつけられる<sup class=\"footnote\">[<a id=\"_footnoteref_3\" class=\"footnote\" href=\"#_footnotedef_3\" title=\"View footnote.\">3</a>]</sup>。</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">文字数制限</div>\nたとえば <code>%(title).50s</code> のように <code>.&lt;数値&gt;</code> を挟めば文字数上限を設定できる。<br>\n（参考： <a href=\"https://github.com/yt-dlp/yt-dlp/issues/1136#issuecomment-932077195\" target=\"_blank\" rel=\"noopener\">Handle Long filenames in default template and temporary files · Issue #1136 · yt-dlp/yt-dlp · GitHub</a>）\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_メタデータの変更\">メタデータの変更</h3>\n<div class=\"paragraph\">\n<p><code>yt-dlp</code> が取得したメタデータは <code>--parse-metadata</code> や <code>--replace-in-metadata</code> オプションを使って修正・変更することができる。<br>\nこれらのオプションで修正・変更したメタデータは <a href=\"#output-template\"><em>Output Template</em></a> で使われる。</p>\n</div>\n<div class=\"dlist\">\n<dl>\n<dt class=\"hdlist1\"><code>--parse-metadata FROM:TO</code></dt>\n<dd>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<colgroup>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\"></th>\n<th class=\"tableblock halign-left valign-top\">Desc</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>FROM</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">元々のメタデータから抽出される、変更前の値。<br>\nフィールド名または <a href=\"#output-template\"><em>Output Template</em></a> 構文で指定する。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>:</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">区切り文字。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>TO</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>FROM</code> の値から各フィールドを抽出するパターンを指定。<br>\n指定されたフィールドは抽出された値で更新される。<br>\nパターンには <a href=\"#output-template\"><em>Output Template</em></a> 構文や <em>python</em> の名前付きグループ<sup class=\"footnote\">[<a id=\"_footnoteref_4\" class=\"footnote\" href=\"#_footnotedef_4\" title=\"View footnote.\">4</a>]</sup>を用いた正規表現を使用する。</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">python 正規表現</div>\n<a href=\"https://docs.python.org/ja/3/library/re.html\" target=\"_blank\" rel=\"noopener\">re --- 正規表現操作 — Python 3.10.0b2 ドキュメント</a>を参照。<br>\n名前付きグループの書式は <code>(?P&lt;name&gt;&#8230;&#8203;)</code> となる。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 7. --parse-metadata の例</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">元のメタデータ</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --print 'title' --print 'artist' S8dmq5YIUoc\nKizuna AI - AIAIAI (feat. 中田ヤスタカ)【Official Music Video】\nKizuna AI (キズナアイ)</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">&lt;code&gt;title&lt;/code&gt; フィールドから &lt;code&gt;artist&lt;/code&gt; と &lt;code&gt;title&lt;/code&gt; の値を抽出して更新</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"4-6,10-20\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp \\\n    --parse-metadata 'title:%(artist)s - %(title)s' \\    <i class=\"conum\" data-value=\"1\"></i><b>(1)</b> <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\n    --print 'title' --print 'artist' S8dmq5YIUoc\nAIAIAI (feat. 中田ヤスタカ)【Official Music Video】\nKizuna AI\n\nyt-dlp \\\n    --parse-metadata 'title:(?P&lt;artist&gt;.+?) - (?P&lt;title&gt;.+?) .*' \\   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b> <i class=\"conum\" data-value=\"3\"></i><b>(3)</b>\n    --print 'title' --print 'artist' S8dmq5YIUoc\nAIAIAI\nKizuna AI</code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>動画タイトルからアーティスト名とタイトル名を分離抽出して、それぞれのフィールドを更新している。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td><a href=\"#output-template\"><em>Output Template</em></a> 構文を利用。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>\n<td><em>python</em> の正規表現を利用。</td>\n</tr>\n</table>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">&lt;code&gt;upload_date&lt;/code&gt; と &lt;code&gt;title&lt;/code&gt; を組み合わせた文字列で &lt;code&gt;title&lt;/code&gt; 値を更新</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"4-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp \\\n    --parse-metadata '%(upload_date)s_%(title)s:%(title)s' \\    <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\n    --print 'title' S8dmq5YIUoc\n20190329_Kizuna AI - AIAIAI (feat. 中田ヤスタカ)【Official Music Video】</code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>タイトルに投稿日を追加させる修正。</td>\n</tr>\n</table>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">複数の重ね合わせが可能</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"5-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp \\\n    --parse-metadata 'title:(?P&lt;artist&gt;.+?) - (?P&lt;title&gt;.+?) .*' \\\n    --parse-metadata '%(upload_date)s@%(artist)s@%(title)s:%(title)s' \\\n    --print 'title' S8dmq5YIUoc\n20190329@Kizuna AI@AIAIAI</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">新しいフィールドを追加</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"4-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp \\\n    --parse-metadata 'artist:%(new_item)s' \\\n    --print 'new_item' S8dmq5YIUoc\nKizuna AI (キズナアイ)</code></pre>\n  </div>\n</div>\n</div>\n</div>\n</dd>\n</dl>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">埋め込みメタデータの値を変更したい</div>\n対象フィールド名に接頭辞 <code>meta_</code> をつけて修正すればいい。<br>\n詳しくは <a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#modifying-metadata\" target=\"_blank\" rel=\"noopener\">README#Modifying Metadata</a> を参照。\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_設定ファイル\">⚙️設定ファイル</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>いつも使うオプションは設定ファイルに記述しておくと便利。</p>\n</div>\n<div class=\"paragraph\">\n<p>設定ファイルの配置場所は<a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#configuration\" target=\"_blank\" rel=\"noopener\">候補がいくつかある</a>けど、とりあえず <code>~/.config/yt-dlp/config</code> ファイルに記述すればよさそう。</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">オプションの優先度</div>\n<code>yt-dlp</code> コマンドに直接オプションを指定したほうが優先される。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 8. yt-dlp の設定ファイル例</div>\n<div class=\"content\">\n<div class=\"paragraph\">\n<p>設定の書式はオプションごとに改行したリストになる。</p>\n</div>\n<div \n    class=\"listingblock\">\n<div class=\"title\">~/.config/yt-dlp/config</div>\n  <div class=\"content\">\n  <pre class=\"highlight \" ><code class=\"language-shell\"\n    data-lang=\"shell\">### Default configuration\n\n# Modify metadata   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\n# variables\n--parse-metadata '%(creator,uploader,channel)s:%(mod_creator)s'\n# for embedding     <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\n--parse-metadata '%(track,title)s:%(meta_title)s'\n--parse-metadata '%(upload_date&gt;%Y-%m-%d)s:%(meta_date)s'\n--parse-metadata '%(artist,mod_creator)s:%(meta_artist)s'\n--parse-metadata '%(album_artist,channel)s:%(meta_album_artist)s'\n--parse-metadata '%(track_number|1)s:%(meta_track)s'\n--parse-metadata '%(description).500s:%(meta_description)s'\n--parse-metadata 'Please show description:%(meta_synopsis)s'\n\n# Download base directory\n--paths \"/mnt/d/video/yt-dlp\"   <i class=\"conum\" data-value=\"3\"></i><b>(3)</b>\n\n# Save file path\n--output '%(mod_creator)s/%(meta_date)s@%(meta_title)s/%(meta_title)s.%(ext)s'\n\n# To be referenced from Windows\n--windows-filenames     <i class=\"conum\" data-value=\"4\"></i><b>(4)</b>\n\n# With thumbnail image\n--write-thumbnail       <i class=\"conum\" data-value=\"5\"></i><b>(5)</b>\n--output 'thumbnail:%(mod_creator)s/%(meta_date)s@%(meta_title)s/cover.%(ext)s'\n\n# Embed metadata\n--add-metadata\n\n# Video Format\n--format 'bestvideo+bestaudio/best' <i class=\"conum\" data-value=\"6\"></i><b>(6)</b>\n\n# Post Processing\n# Export metadata in same directory <i class=\"conum\" data-value=\"7\"></i><b>(7)</b>\n--exec \"jq --null-input --sort-keys '{ title: %(title)j, id: %(id)j, date: %(meta_date)j, tags: %(tags|[])j, url: %(webpage_url)j, artist: %(meta_artist)j,  channel: %(channel)j, channel_id: %(channel_id)j }' &gt; \\\"$(dirname %(filepath)q)/%(id)s.info.json\\\"\"</code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>動画のメタデータを変更。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td>埋め込み用メタデータの値を修正している。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>\n<td>出力先ルートディレクトリを指定。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"4\"></i><b>4</b></td>\n<td><em>Windows</em> と共有するのでファイル名に互換性をもたせる。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"5\"></i><b>5</b></td>\n<td>サムネイル画像も一緒にダウンロード。<br>\nまた、画像ファイル名が <code>cover.&lt;ext&gt;</code> になるように指定。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"6\"></i><b>6</b></td>\n<td>動画フォーマットを指定。<br>\n指定方法やフィルタリングについては <a href=\"https://github.com/yt-dlp/yt-dlp/blob/2021.12.01/README.md#format-selection\" target=\"_blank\" rel=\"noopener\">README#Format Selection</a> を参照。</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"7\"></i><b>7</b></td>\n<td>ダウンロード処理実行後に <code>jq</code> コマンドを通して<sup class=\"footnote\">[<a id=\"_footnoteref_5\" class=\"footnote\" href=\"#_footnotedef_5\" title=\"View footnote.\">5</a>]</sup>メタデータの一部を出力している。</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">メタデータ</div>\n<div class=\"paragraph\">\n<p><code>--write-info-json</code> オプションを使うとメタデータを出力してくれるんだけど、あらゆる情報が大量に出力される（4MB 以上になったりする）。<br>\nそのためメタデータの一部だけを抽出するのに <code>--exec</code> オプションを利用している。</p>\n</div>\n<div class=\"paragraph\">\n<p>……ただ、Linuxなら<sup class=\"footnote\">[<a id=\"_footnoteref_6\" class=\"footnote\" href=\"#_footnotedef_6\" title=\"View footnote.\">6</a>]</sup> <em>tmpfs</em> なディレクトリに <code>--wirte-info-json</code> で書き出した後に <code>jq</code> で抽出したほうがよさそう……。</p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_トラブルシューティング\">🛠️トラブルシューティング</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_output_template_周りのエラー\"><em>Output Template</em> 周りのエラー</h3>\n<div class=\"paragraph\">\n<p>だいたい <strong><a href=\"#output-template_format-type\">末尾のフォーマット型</a>のつけ忘れ</strong> が原因。<br>\nまずエラーが起こったらつけ忘れを疑うべき。</p>\n</div>\n<div class=\"exampleblock\">\n<div class=\"content\">\n<div \n    class=\"listingblock\">\n<div class=\"title\">❌つけ忘れ！！！</div>\n  <div class=\"content\">\n  <pre class=\"highlight \" ><code class=\"language-shell\"\n    data-lang=\"shell\">--output '%(upload_date) %(title).%(ext)'</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock\">\n<div class=\"title\">⭕ヨシ！</div>\n  <div class=\"content\">\n  <pre class=\"highlight \" ><code class=\"language-shell\"\n    data-lang=\"shell\">--output '%(upload_date)<strong class=\"text-red-500\">s</strong> %(title)<strong class=\"text-red-500\">s</strong>.%(ext)<strong class=\"text-red-500\">s</strong>'</code></pre>\n  </div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_python_no_such_file_or_directory\">‘python’: No such file or directory</h3>\n<div class=\"dlist\">\n<dl>\n<dt class=\"hdlist1\">エラー</dt>\n<dd>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">yt-dlp --version\n/usr/bin/env: ‘python’: No such file or directory</code></pre>\n  </div>\n</div>\n</dd>\n<dt class=\"hdlist1\">原因</dt>\n<dd>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">python3しかない</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"4-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">which python    # Nothing!\nwhich python2   # Nothing!\nwhich python3\n/usr/bin/python3</code></pre>\n  </div>\n</div>\n</dd>\n<dt class=\"hdlist1\">対策</dt>\n<dd>\n<p><code>update-alternatives</code> コマンドで <code>python</code> が <code>/usr/bin/python3</code> を参照するように設定すればいい。</p>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"wsl\"\n    data-host=\"debian\"\n    data-output=\"2-3,5-20\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">sudo update-alternatives --install /usr/local/bin/python python /usr/bin/python3 40\nupdate-alternatives: using /usr/bin/python3 to provide /usr/local/bin/python (python) in auto mode\n\nupdate-alternatives --query python\nName: python\nLink: /usr/local/bin/python\nStatus: auto\nBest: /usr/bin/python3\nValue: /usr/bin/python3\n\nAlternative: /usr/bin/python3\nPriority: 40</code></pre>\n  </div>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\n単にシンボリックリンクを張るのでも解決するが、<em>alternatives</em> システムを利用することが推奨される。\n</td>\n</tr>\n</table>\n</div>\n</dd>\n</dl>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\">📖参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/yt-dlp/yt-dlp\" target=\"_blank\" rel=\"noopener\">yt-dlp/yt-dlp: A youtube-dl fork with additional features and fixes</a></p>\n</li>\n</ul>\n</div>\n<div class=\"ulist\">\n<div class=\"title\">python</div>\n<ul>\n<li>\n<p><a href=\"https://linuxhint.com/update_alternatives_ubuntu/\" target=\"_blank\" rel=\"noopener\">How to Use update-alternatives Command on Ubuntu</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div id=\"footnotes\">\n<hr>\n<div class=\"footnote\" id=\"_footnotedef_1\">\n<a href=\"#_footnoteref_1\">1</a>. マージするには <code>ffmpeg</code> が必要。\n</div>\n<div class=\"footnote\" id=\"_footnotedef_2\">\n<a href=\"#_footnoteref_2\">2</a>. 絶対に音声を含みたくない場合は、末尾の <code>*</code> を取り除く。\n</div>\n<div class=\"footnote\" id=\"_footnotedef_3\">\n<a href=\"#_footnoteref_3\">3</a>. 文字列に含まれる記号によってはとんでもないことになる……。\n</div>\n<div class=\"footnote\" id=\"_footnotedef_4\">\n<a href=\"#_footnoteref_4\">4</a>. グループの名前がフィールド名に相当する。\n</div>\n<div class=\"footnote\" id=\"_footnotedef_5\">\n<a href=\"#_footnoteref_5\">5</a>. <code>jq</code> コマンドを通すと <em>Unicode</em> 符号をいい感じに解釈してくれる。\n</div>\n<div class=\"footnote\" id=\"_footnotedef_6\">\n<a href=\"#_footnoteref_6\">6</a>. <em>WSL</em> では <em>tmpfs</em> の実態がメモリではなくファイルになってしまうので残念。\n</div>\n</div>","title":"動画ダウンロードツール youtube-dl のフォークである yt-dlp を使ってみる","created_at":"2021-12-20","tags":["cli","python","downloader","youtube"],"updated_at":"2022-07-12","author":"秋々すすき","revision":"1.1","revision_remark":"取得する文字数を制限する方法について追記。"}