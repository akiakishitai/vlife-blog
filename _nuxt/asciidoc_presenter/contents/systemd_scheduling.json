{"filename":"systemd_scheduling.adoc","rendered":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">ç›®æ¬¡</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_ã¯ã˜ã‚ã«\">ğŸã¯ã˜ã‚ã«</a></li>\n<li><a href=\"#_systemd_ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè¡Œã‚¸ãƒ§ãƒ–ã‚’è¨­å®š\">ğŸ•â€ğŸ¦º <em>systemd</em> ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè¡Œã‚¸ãƒ§ãƒ–ã‚’è¨­å®š</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_ã‚¸ãƒ§ãƒ–ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦ä½œæˆ\">ã‚¸ãƒ§ãƒ–ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦ä½œæˆ</a></li>\n<li><a href=\"#_systemd_ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ\"><em>systemd</em> ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ</a></li>\n</ul>\n</li>\n<li><a href=\"#_systemd_timer_ã‚’ä½¿ã£ã¦å®šæœŸçš„ã«_systemd_service_ã‚’å®Ÿè¡Œ\">â° <em>systemd.timer</em> ã‚’ä½¿ã£ã¦å®šæœŸçš„ã« <em>systemd.service</em> ã‚’å®Ÿè¡Œ</a></li>\n<li><a href=\"#_è£œè¶³äº‹é …\">ğŸ–Šï¸è£œè¶³äº‹é …</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_about_oncalendar_value\">OnCalendar ã®å€¤ã«ã¤ã„ã¦</a></li>\n<li><a href=\"#_ã‚·ã‚¹ãƒ†ãƒ çµ‚äº†æ™‚ã«_systemd_service_ã‚’å®Ÿè¡Œã—ãŸã„å ´åˆ\">ã‚·ã‚¹ãƒ†ãƒ çµ‚äº†æ™‚ã« <em>systemd.service</em> ã‚’å®Ÿè¡Œã—ãŸã„å ´åˆ</a></li>\n</ul>\n</li>\n<li><a href=\"#_å‚è€ƒ\">ğŸ“–å‚è€ƒ</a></li>\n</ul>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_ã¯ã˜ã‚ã«\">ğŸã¯ã˜ã‚ã«</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><code>cron</code> ã‚’ä½¿ã‚ãšã¨ã‚‚ <em>systemd</em> ã‚’ä½¿ã£ã¦ã‚¸ãƒ§ãƒ–ã‚’å®šæœŸçš„ã«å®Ÿè¡Œã§ãã‚‹ã€‚<br>\nä¸€èˆ¬çš„ãªLinuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯ <em>systemd</em> ã‚’ä½¿ã£ã¦ã„ã‚‹ãŸã‚ã€ã“ã¡ã‚‰ã®åˆ©ç”¨æ–¹æ³•ã‚’å‚™å¿˜éŒ²ã—ã¦ãŠãã€‚</p>\n</div>\n<div class=\"paragraph\">\n<p>ä»Šå›ã‚„ã‚‹ <em>systemd</em> ã«ã‚ˆã‚‹å®šæœŸå®Ÿè¡Œã«ã¤ã„ã¦ã¯ã€</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>å®Ÿè¡Œã—ãŸã„ã‚¸ãƒ§ãƒ–ã‚’ <em>systemd</em> ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦è¨­å®š</p>\n</li>\n<li>\n<p><em>systemd.timer</em> ã‹ã‚‰ä¸Šè¨˜ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®Ÿè¡Œ</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>ã¨ã™ã‚Œã°ã„ã„ã€‚</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_systemd_ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè¡Œã‚¸ãƒ§ãƒ–ã‚’è¨­å®š\">ğŸ•â€ğŸ¦º <em>systemd</em> ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè¡Œã‚¸ãƒ§ãƒ–ã‚’è¨­å®š</h2>\n<div class=\"sectionbody\">\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>å®Ÿè¡Œã™ã‚‹ã‚¸ãƒ§ãƒ–ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã™ã‚‹</p>\n</li>\n<li>\n<p>ä¸Šè¨˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ <em>systemd.service</em> ã‚’ä½œæˆ</p>\n</li>\n</ol>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\" data-md-icon=\"report\"></i>\n</td>\n<td class=\"content\">\nä»Šå›ä½œæˆã™ã‚‹ <em>systemd.service</em> ã¯ <em>systemd</em> ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§å‹•ã‹ã™ï¼ˆ<code>systemctl --user &lt;subcommand&gt;</code>ï¼‰ã“ã¨ã‚’å‰æã«ã™ã‚‹ã€‚\n</td>\n</tr>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_ã‚¸ãƒ§ãƒ–ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦ä½œæˆ\">ã‚¸ãƒ§ãƒ–ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦ä½œæˆ</h3>\n<div class=\"paragraph\">\n<p><em>systemd.service</em> ã«ã‚³ãƒãƒ³ãƒ‰ã‚’ç›´æ¥è¨˜è¿°ã™ã‚‹å ´åˆã¯ã„ãã¤ã‹æ³¨æ„ã™ã¹ãç‚¹ãŒã‚ã‚‹<sup class=\"footnote\">[<a id=\"_footnoteref_1\" class=\"footnote\" href=\"#_footnotedef_1\" title=\"View footnote.\">1</a>]</sup>ã€‚<br>\nã‚ˆã£ã¦ã€å®Ÿè¡Œã—ãŸã„ã‚¸ãƒ§ãƒ–ã¯ã‚ã‚‰ã‹ã˜ã‚ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã—ã¦ãŠãã“ã¨ã‚’æ¨å¥¨ã€‚</p>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 1. ã‚¸ãƒ§ãƒ–ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">å¼•æ•°ã‚’æ¨™æº–å‡ºåŠ›ã«è¿”ã™ã ã‘ã®ãƒ†ã‚¹ãƒˆç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"3-6\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">mkdir -p ~/.local/bin    <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\ntee ~/.local/bin/hello.sh &lt;&lt;'EOF'\n#!/bin/bash\necho \"Hello,\" \"$@\" \"!\"\nEOF\n\nchmod u+x ~/.local/bin/hello.sh    <i class=\"conum\" data-value=\"2\"></i><b>(2)</b></code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td><em>systemd</em> ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§ä½¿ã†ãŸã‚ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ <code>~/.local/bin</code> ã«é…ç½®ã—ãŸã€‚</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td>å®Ÿè¡Œæ¨©é™ã‚’ä¸ãˆã‚‹ã“ã¨ã‚’å¿˜ã‚Œãšã«ã€‚</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n<hr>\n<details>\n<summary class=\"title\">ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’è¨˜è¿°ã™ã‚‹å ´åˆã¯ã€ã“ã†ã„ã†ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚</summary>\n<div class=\"content\">\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">systemd.service Exec</div>\n<div class=\"paragraph\">\n<p>ã‚·ã‚§ãƒ«æ§‹æ–‡ã¯å¤‰æ•°ã®å±•é–‹ï¼ˆ<code>${&#8230;&#8203;}</code>ï¼‰ãã‚‰ã„ã—ã‹ä½¿ãˆãªã„ï¼ˆãªãŠãƒã‚¹ãƒˆã•ã‚ŒãŸå¤‰æ•°å±•é–‹ã¯ã†ã¾ãæ©Ÿèƒ½ã—ãªã„ï¼‰ã€‚<br>\nãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆ<code>&gt;</code>, <code>&gt;&gt;</code> <code>&lt;</code>, <code>&lt;&lt;</code>ï¼‰ã‚„ãƒ‘ã‚¤ãƒ—ï¼ˆ<code>|</code>ï¼‰ã‚’ä½¿ã„ãŸã„å ´åˆã¯ ã‚·ã‚§ãƒ«ï¼ˆ<code>sh</code>, <code>bash</code>ï¼‰ã«å¼•æ•°ã¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰æ–‡ã‚’æ¸¡ã™ã—ã‹ãªã„ã€‚<br>\nï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä½œæˆã—ã¦ãŠã„ã¦ã€ãã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã»ã†ãŒç­‹ã¨ã—ã¦ã¯è‰¯ã•ãã†ï¼‰</p>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">ExecStart=bash -c \"echo 'hoge' &gt; /tmp/hoge.txt\"</code></pre>\n  </div>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">systemd.service Exec</div>\n<div class=\"paragraph\">\n<p>ã‚³ãƒãƒ³ãƒ‰ãŒçµ¶å¯¾ãƒ‘ã‚¹ã§ä¸ãˆã‚‰ã‚Œã¦ã„ãªã„å ´åˆã€<code>systemd</code> ã¯ã‚·ã‚¹ãƒ†ãƒ ã”ã¨ã«æ±ºã‚ã‚‰ã‚ŒãŸãƒ‘ã‚¹ã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ã‚’æ¤œç´¢ã™ã‚‹ã€‚<br>\nåŸºæœ¬çš„ã«ã¯çµ¶å¯¾ãƒ‘ã‚¹ã‚’ä½¿ã†ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã‚‹ã€‚</p>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">systemd ãŒã‚³ãƒãƒ³ãƒ‰ã‚’æ¤œç´¢ã™ã‚‹ãƒ‘ã‚¹ã®ç¢ºèª</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">systemd-path search-binaries-default | tr \":\" \" \"\n/usr/local/sbin /usr/local/bin /usr/sbin /usr/bin /sbin /bin</code></pre>\n  </div>\n</div>\n</td>\n</tr>\n</table>\n</div>\n</div>\n</details>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_systemd_ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ\"><em>systemd</em> ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ</h3>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 2. systemd.service ã‚’ä½œæˆ</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">systemd.service ã‚’æ–°è¦ä½œæˆ</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">systemctl edit --user --force --full demo@.service</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock\">\n<div class=\"title\">~/.config/systemd/user/demo@.service</div>\n  <div class=\"content\">\n  <pre class=\"highlight \" ><code class=\"language-ini\"\n    data-lang=\"ini\">[Unit]\nDescription=Demo service\n\n[Service]\nType=oneshot\nExecStart=%h/.local/bin/hello.sh %i   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\n\n[Install]\nWantedBy=multi-user.target</code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td><a href=\"https://man.archlinux.org/man/systemd.unit.5.en#SPECIFIERS\" target=\"_blank\" rel=\"noopener\">ãƒ¦ãƒ‹ãƒƒãƒˆæŒ‡å®šå­</a>ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã€‚<br>\n<code>%h</code> &#8594; ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®Ÿè¡Œã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹ã€‚<br>\n<code>%i</code> &#8594; ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆåã® <code>@</code> è¨˜å·ã‹ã‚‰æ‹¡å¼µå­ã¾ã§ã®é–“ã«ã‚ã‚‹æ–‡å­—åˆ—ï¼‰ã€‚</td>\n</tr>\n</table>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">service ã‚’ãƒ†ã‚¹ãƒˆèµ·å‹•</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"3-20\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">systemctl --user start demo@sample.service\nsystemctl --user status demo@sample.service\nâ— demo@sample.service - Demo service\n     Loaded: loaded (/home/hoge/.config/systemd/user/demo@.service; disabled; vendor preset: enabled)\n     Active: inactive (dead)\n\nOct 23 22:12:38 raspberrypi systemd[747]: Starting Demo service...\nOct 23 22:12:38 raspberrypi hello.sh[15180]: Hello, sample !\nOct 23 22:12:38 raspberrypi systemd[747]: demo@sample.service: Succeeded.\nOct 23 22:12:38 raspberrypi systemd[747]: Started Demo service.</code></pre>\n  </div>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\nãƒ¦ãƒ‹ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ï¼ˆ<code>.service</code> ã‚„ <code>.socket</code>ï¼‰ã®ç›´å‰ã« <code>@</code> è¨˜å·ã‚’ã¤ã‘ã‚‹ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¦ãƒ‹ãƒƒãƒˆã«ãªã‚‹ã€‚<br>\nå¼•æ•°ã‚’ä¸ãˆã¦ãƒ¦ãƒ‹ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æŒ™å‹•ã‚’ä¸€éƒ¨å¤‰æ›´ã•ã›ãŸã„ã¨ãã«ä¾¿åˆ©ã€‚\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_systemd_timer_ã‚’ä½¿ã£ã¦å®šæœŸçš„ã«_systemd_service_ã‚’å®Ÿè¡Œ\">â° <em>systemd.timer</em> ã‚’ä½¿ã£ã¦å®šæœŸçš„ã« <em>systemd.service</em> ã‚’å®Ÿè¡Œ</h2>\n<div class=\"sectionbody\">\n<div class=\"exampleblock\">\n<div class=\"title\">Example 3. systemd.timer ã§å®šæœŸå®Ÿè¡Œ</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">systemd.timer ã‚’æ–°è¦ä½œæˆ</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">systemctl edit --user --force --full demo@schedule.timer</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock\">\n<div class=\"title\">~/.config/systemd/user/demo@schedule.timer</div>\n  <div class=\"content\">\n  <pre class=\"highlight \" ><code class=\"language-ini\"\n    data-lang=\"ini\">[Timer]\nOnCalendar=*-*-* *:00/10:00   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\nAccuracySec=1m  <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\n#Unit=demo@sample.service   <i class=\"conum\" data-value=\"3\"></i><b>(3)</b></code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>10åˆ†æ¯ã«å®šæœŸå®Ÿè¡Œã€‚æ›¸å¼ã«ã¤ã„ã¦ã¯<a href=\"#_about_oncalendar_value\">å¾Œè¿°</a>ã€‚</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td>ç²¾åº¦ã€‚ã“ã“ã®ä¾‹ã§ã¯æŒ‡å®šã—ãŸæ™‚åˆ»ã‹ã‚‰1åˆ†ä»¥å†…ã®ã©ã“ã‹ã§å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚<br>\nå°ã•ãã™ã‚Œã°ã™ã‚‹ã»ã©CPUè² è·ãŒé«˜ããªã‚‹ã®ã§æ³¨æ„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯1åˆ†ï¼‰ã€‚</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>\n<td>ã“ã® <em>timer</em> ã§å®Ÿè¡Œã™ã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆã‚’æŒ‡å®šã™ã‚‹ï¼ˆæœ¬ä¾‹ã§ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰ã€‚<br>\næŒ‡å®šãŒãªã‘ã‚Œã° <em>timer</em> ã¨åŒåã® <em>service</em> ã‚’å®Ÿè¡Œã™ã‚‹ã€‚</td>\n</tr>\n</table>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">ã‚¿ã‚¤ãƒãƒ¼ã‚’ãƒ†ã‚¹ãƒˆèµ·å‹•</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"3-20\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">systemctl --user start demo@schedule.timer\nsystemctl --user status demo@schedule.timer\nâ— demo@schedule.timer\n     Loaded: loaded (/home/suzutsuki/.config/systemd/user/demo@schedule.timer; static)\n     Active: active (waiting) since Sun 2021-10-24 00:05:15 JST; 9s ago\n    Trigger: Sun 2021-10-24 00:10:00 JST; 4min 35s left\n   Triggers: â— demo@schedule.service\n\nOct 24 00:05:15 raspberrypi systemd[747]: Started demo@schedule.timer.</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">ãƒ­ã‚°ã‚’ç¢ºèª</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-30\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">journalctl --user --unit demo@schedule.service\nOct 24 00:10:22 raspberrypi systemd[747]: Starting Demo service...\nOct 24 00:10:22 raspberrypi hello.sh[16109]: Hello, schedule !\nOct 24 00:10:22 raspberrypi systemd[747]: demo@schedule.service: Succeeded.\nOct 24 00:10:22 raspberrypi systemd[747]: Started Demo service.\nOct 24 00:20:22 raspberrypi systemd[747]: Starting Demo service...\nOct 24 00:20:22 raspberrypi hello.sh[16125]: Hello, schedule !\nOct 24 00:20:22 raspberrypi systemd[747]: demo@schedule.service: Succeeded.\nOct 24 00:20:22 raspberrypi systemd[747]: Started Demo service.\nOct 24 00:30:22 raspberrypi systemd[747]: Starting Demo service...\nOct 24 00:30:22 raspberrypi hello.sh[16133]: Hello, schedule !\nOct 24 00:30:22 raspberrypi systemd[747]: demo@schedule.service: Succeeded.\nOct 24 00:30:22 raspberrypi systemd[747]: Started Demo service.\nOct 24 00:40:22 raspberrypi systemd[747]: Starting Demo service...</code></pre>\n  </div>\n</div>\n</div>\n</div>\n<hr>\n<div class=\"paragraph\">\n<p>ä½œæˆã—ãŸ <em>systemd.timer</em> ãŒæœŸå¾…é€šã‚Šå‹•ä½œã™ã‚‹ã‚ˆã†ãªã‚‰OKã€‚<br>\nã‚ã¨ã¯è‡ªå‹•èµ·å‹•ã‚’æœ‰åŠ¹åŒ–ã—ã¦ãŠãã€‚</p>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">ã‚¿ã‚¤ãƒãƒ¼ã®è‡ªå‹•èµ·å‹•ã‚’æœ‰åŠ¹åŒ–</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">systemctl --user enable demo@schedule.timer</code></pre>\n  </div>\n</div>\n<div class=\"paragraph\">\n<p>ğŸ˜ğŸ‘</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_è£œè¶³äº‹é …\">ğŸ–Šï¸è£œè¶³äº‹é …</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_about_oncalendar_value\">OnCalendar ã®å€¤ã«ã¤ã„ã¦</h3>\n<div class=\"paragraph\">\n<p><a href=\"https://man.archlinux.org/man/systemd.time.7.en\" target=\"_blank\" rel=\"noopener\">systemd.time(7) â€” Arch manual pages</a> ã‚’å‚è€ƒã€‚<br>\næ›¸å¼ã¨ã—ã¦ã¯ <code>YYYY-MM-DD hh:mm:ss</code> ã®å½¢ã«ãªã‚‹ï¼ˆæ›œæ—¥æŒ‡å®šã‚‚ã§ãã‚‹ã‘ã©å‰²æ„›ï¼‰ã€‚</p>\n</div>\n<div class=\"paragraph\">\n<p>ã“ã®å€¤ã«ã¤ã„ã¦ã®æ¤œè¨¼ã¯ <code>systemd-analyze calendar</code> ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã€‚</p>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 4. OnCalendar ã®å€¤ã«ã¤ã„ã¦æ¤œè¨¼ä¾‹</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-3,5-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">systemd-analyze calendar '4h'\nFailed to parse calendar specification '4h': Invalid argument\n\nsystemd-analyze calendar '00,04,08,12,16,20:15:00'\n  Original form: 00,04,08,12,16,20:15:00\nNormalized form: *-*-* 00,04,08,12,16,20:15:00\n    Next elapse: Sun 2021-10-24 00:15:00 JST\n       (in UTC): Sat 2021-10-23 15:15:00 UTC\n       From now: 1h 58min left</code></pre>\n  </div>\n</div>\n</div>\n</div>\n<table class=\"tableblock frame-all grid-all fit-content\">\n<caption class=\"title\">Table 1. OnCalendarã§ä½¿ãˆã‚‹è¨˜å·</caption>\n<colgroup>\n<col>\n<col>\n<col>\n<col>\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-center valign-top\">è¨˜å·</th>\n<th class=\"tableblock halign-left valign-top\">èª¬æ˜</th>\n<th class=\"tableblock halign-center valign-top\">ä½¿ç”¨ä¾‹</th>\n<th class=\"tableblock halign-left valign-top\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>*</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰<br>\nï¼ˆä»»æ„ã®å€¤ï¼‰</p></td>\n<td class=\"tableblock halign-left valign-top\"><div class=\"literal\"><pre>*-*-* *:30:00</pre></div></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">æ™‚åˆ»ãŒ30åˆ†ã‚’æŒ‡ã™ãŸã³ã«å®Ÿè¡Œã€‚</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>,</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">è¤‡æ•°æŒ‡å®š</p></td>\n<td class=\"tableblock halign-left valign-top\"><div class=\"literal\"><pre>*-*-10,20 00:00:00</pre></div></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">10æ—¥ã¨20æ—¥ã®åˆå‰0æ™‚ã«å®Ÿè¡Œã€‚</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>..</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">ç¯„å›²æŒ‡å®š</p></td>\n<td class=\"tableblock halign-left valign-top\"><div class=\"literal\"><pre>*-*-05..10 12:00:00</pre></div></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">5æ—¥ã‹ã‚‰10æ—¥ã«ã‹ã‘ã¦ã€12æ™‚ã«å®Ÿè¡Œã€‚</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>/</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">ç¹°ã‚Šè¿”ã—é–“éš”</p></td>\n<td class=\"tableblock halign-left valign-top\"><div class=\"literal\"><pre>*-*-* *:00/15:00</pre></div></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">15åˆ†ã”ã¨ã«å®Ÿè¡Œã€‚<br>\nï¼ˆ00, 15, 30, 45åˆ†æ™‚ã«ãã‚Œãã‚Œå®Ÿè¡Œï¼‰</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-center valign-top\"><p class=\"tableblock\"><code>~</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">æœˆæœ«æœ€çµ‚æ—¥ã‹ã‚‰</p></td>\n<td class=\"tableblock halign-left valign-top\"><div class=\"literal\"><pre>*-10~03 00:00:00</pre></div></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">10æœˆæœ«ã‹ã‚‰æ•°ãˆã¦3æ—¥ç›®ã€<br>\nã¤ã¾ã‚Š10æœˆ29æ—¥ã®åˆå‰0æ™‚ã«å®Ÿè¡Œã€‚</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_ã‚·ã‚¹ãƒ†ãƒ çµ‚äº†æ™‚ã«_systemd_service_ã‚’å®Ÿè¡Œã—ãŸã„å ´åˆ\">ã‚·ã‚¹ãƒ†ãƒ çµ‚äº†æ™‚ã« <em>systemd.service</em> ã‚’å®Ÿè¡Œã—ãŸã„å ´åˆ</h3>\n<div class=\"paragraph\">\n<p><code>shutdown.target</code> å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ <em>systemd.service</em> ã¨ã—ã¦å®Ÿè£…ã™ã‚Œã°ã„ã„ï¼ˆ<em>systemd.timer</em> ã¯ä½¿ã‚ãªã„ï¼‰ã€‚</p>\n</div>\n<div class=\"admonitionblock caution\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-caution\" title=\"Caution\" data-md-icon=\"local_fire_department\"></i>\n</td>\n<td class=\"content\">\nã“ã®æ–¹æ³•ã§ã¯<strong>é›»æºå–ªå¤±ï¼ˆåœé›»ãªã©ï¼‰ã«å¯¾å¿œã§ããªã„</strong>ã“ã¨ã«æ³¨æ„ã€‚<br>\né€šå¸¸ã®ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³æ“ä½œãŒå®Ÿè¡Œã•ã‚ŒãŸæ™‚ã®ã¿æœ‰åŠ¹ã¨ãªã‚‹ã€‚\n</td>\n</tr>\n</table>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 5. ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³æ™‚ã«å®Ÿè¡Œã•ã›ãŸã„å ´åˆã®ä¾‹</div>\n<div class=\"content\">\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ systemd.service</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    data-output=\"2-30\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">sudo systemctl edit --force --full run-on-shutdown.service</code></pre>\n  </div>\n</div>\n<div \n    class=\"listingblock\">\n\n  <div class=\"content\">\n  <pre class=\"highlight \" ><code class=\"language-ini\"\n    data-lang=\"ini\">[Unit]\nDescription=Run scripts on shutdown\nBefore=shutdown.target   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\nDefaultDependencies=no   <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=/usr/local/bin/run-on-shutdown.sh\n\n[Install]\nWantedBy=shutdown.target <i class=\"conum\" data-value=\"3\"></i><b>(3)</b></code></pre>\n  </div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã™ã‚‹å‰ã«ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®Ÿè¡Œã•ã›ã‚‹ã€‚</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td>èµ·å‹•åˆæœŸã‚„ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³æ™‚ã«å®Ÿè¡Œã•ã›ã‚‹å ´åˆã¯ <em>no</em> ã«ã—ãŸã»ã†ãŒã„ã„ã‚‰ã—ã„ã€‚</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>\n<td>ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³æ™‚ã«å®Ÿè¡Œã•ã›ã‚‹ãŸã‚ã®æŒ‡å®šã€‚</td>\n</tr>\n</table>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n<div class=\"title\">æœ‰åŠ¹åŒ–</div>\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"pi\"\n    data-host=\"raspi\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">sudo systemctl daemon-reload\nsudo systemctl enable run-on-shutdown.service</code></pre>\n  </div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_å‚è€ƒ\">ğŸ“–å‚è€ƒ</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<div class=\"title\">systemd.service</div>\n<ul>\n<li>\n<p><a href=\"https://man.archlinux.org/man/systemd.service.5.en\" target=\"_blank\" rel=\"noopener\">systemd.service(5) â€” Arch manual pages</a></p>\n</li>\n<li>\n<p><a href=\"https://man.archlinux.org/man/systemd.unit.5.en\" target=\"_blank\" rel=\"noopener\">systemd.unit(5) â€” Arch manual pages</a></p>\n</li>\n<li>\n<p><a href=\"https://www.freedesktop.org/software/systemd/man/systemd.syntax.html#\" target=\"_blank\" rel=\"noopener\">systemd.syntax</a></p>\n</li>\n<li>\n<p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units-ja\" target=\"_blank\" rel=\"noopener\">Systemctlã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦Systemdã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ¦ãƒ‹ãƒƒãƒˆã‚’ç®¡ç†ã™ã‚‹æ–¹æ³• | DigitalOcean</a></p>\n</li>\n<li>\n<p><a href=\"https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/7/html/system_administrators_guide/sect-managing_services_with_systemd-unit_files\" target=\"_blank\" rel=\"noopener\">10.6. systemd ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆãŠã‚ˆã³å¤‰æ›´ RedÂ Hat Enterprise Linux 7 | Red Hat Customer Portal</a></p>\n</li>\n<li>\n<p><a href=\"https://enakai00.hatenablog.com/entry/20130917/1379374797\" target=\"_blank\" rel=\"noopener\">Systemdå…¥é–€(4) - serviceã‚¿ã‚¤ãƒ—Unitã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« - ã‚ã‚‚ã‚ã‚‚</a></p>\n</li>\n<li>\n<p><a href=\"https://askubuntu.com/questions/1312766/systemd-script-not-running-on-shutdown\" target=\"_blank\" rel=\"noopener\">bash - Systemd script not running on shutdown - Ask Ubuntu</a></p>\n</li>\n</ul>\n</div>\n<div class=\"ulist\">\n<div class=\"title\">systemd.timer</div>\n<ul>\n<li>\n<p><a href=\"https://wiki.archlinux.jp/index.php/Systemd/%E3%82%BF%E3%82%A4%E3%83%9E%E3%83%BC\" target=\"_blank\" rel=\"noopener\">systemd/ã‚¿ã‚¤ãƒãƒ¼ - ArchWiki</a></p>\n</li>\n<li>\n<p><a href=\"https://man.archlinux.org/man/systemd.timer.5\" target=\"_blank\" rel=\"noopener\">systemd.timer(5) â€” Arch manual pages</a></p>\n</li>\n<li>\n<p><a href=\"https://man.archlinux.org/man/systemd.time.7.en\" target=\"_blank\" rel=\"noopener\">systemd.time(7) â€” Arch manual pages</a></p>\n</li>\n<li>\n<p><a href=\"https://man.archlinux.org/man/systemd-analyze.1.en\" target=\"_blank\" rel=\"noopener\">systemd-analyze(1) â€” Arch manual pages</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div id=\"footnotes\">\n<hr>\n<div class=\"footnote\" id=\"_footnotedef_1\">\n<a href=\"#_footnoteref_1\">1</a>. <code>bash</code> ã®ç’°å¢ƒå¤‰æ•°ãŒä½¿ãˆãªã„ã¨ã‹å¤‰æ•°å±•é–‹ãŒã†ã¾ãã„ã‹ãªã„ã¨ã‹ã€‚\n</div>\n</div>","title":"systemd ã‚’ä½¿ã£ã¦ã‚¸ãƒ§ãƒ–ã‚’å®šæœŸå®Ÿè¡Œã•ã›ã‚‹å‚™å¿˜éŒ²","created_at":"2021-10-25","tags":["linux","systemd","timer","å‚™å¿˜éŒ²"],"updated_at":"2021-10-25","author":"ç§‹ã€…ã™ã™ã","revision":"1.0"}