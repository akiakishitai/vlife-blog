{"filename":"linux_bash_completion.adoc","rendered":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">目次</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_結論\">🍰結論</a></li>\n<li><a href=\"#_ソースを確認してみた\">🔍ソースを確認してみた</a></li>\n<li><a href=\"#_参考\">📖参考</a></li>\n</ul>\n</div>\n<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>備忘録としてメモ。</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_結論\">🍰結論</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>自作またはダウンロードした補完スクリプトは次のうちどちらかのディレクトリに配置すればいい。</p>\n</div>\n<div class=\"dlist\">\n<dl>\n<dt class=\"hdlist1\">ユーザーごとの適用</dt>\n<dd>\n<p><code>~/.local/share/bash-completion/completions/</code></p>\n</dd>\n<dt class=\"hdlist1\">システム全体で適用</dt>\n<dd>\n<p><code>/usr/local/share/bash-completion/completions/</code></p>\n</dd>\n</dl>\n</div>\n<div class=\"admonitionblock tip\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">パッケージの場合</div>\n<div class=\"paragraph\">\n<p>パッケージで補完スクリプトを管理する場合は <code>pkg-config --variable=completionsdir bash-completion</code> で表示されるディレクトリに配置する。</p>\n</div>\n<div \n    class=\"listingblock no-line-numbers command-line\">\n\n  <div class=\"content\">\n  <pre class=\"highlight command-line\" data-user=\"user\"\n    data-host=\"local\"\n    data-output=\"2-10\"\n    ><code class=\"language-bash\"\n    data-lang=\"bash\">pkg-config --variable=completionsdir bash-completion\n/usr/share/bash-completion/completions</code></pre>\n  </div>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">ファイル名について</div>\n補完スクリプトのファイル名は <code>&lt;コマンド名&gt;</code> もしくは <code>&lt;コマンド名&gt;.bash</code> とする。\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_ソースを確認してみた\">🔍ソースを確認してみた</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"https://github.com/scop/bash-completion/tree/2.11\" target=\"_blank\" rel=\"noopener\"><em>bash_completion</em> (v2.11)</a> のソースを確認してみると、<a href=\"https://github.com/scop/bash-completion/blob/b12639a6becec13a0a2c06173ba40fb3bbe972e1/bash_completion#L2175-L2216\" target=\"_blank\" rel=\"noopener\">bash_completion ファイルの __load_completion() 関数</a>で補完スクリプトファイルを読み込んでいるっぽい。</p>\n</div>\n<div class=\"paragraph\">\n<p>上記の関数内において補完スクリプトが探索されるディレクトリは次の2種類。</p>\n</div>\n<div class=\"exampleblock\">\n<div class=\"title\">Example 1. 読み込み先ディレクトリ</div>\n<div class=\"content\">\n<div class=\"dlist\">\n<dl>\n<dt class=\"hdlist1\"><code>${BASH_COMPLETION_USER_DIR}/completions</code></dt>\n<dd>\n<p>デフォルト値は <code>$HOME/.local/share/bash-completion/completions</code> となる。</p>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">変数のデフォルト値について補足</div>\n<div class=\"paragraph\">\n<p><code>$BASH_COMPLETION_USER_DIR</code> &#8594; <em>$XDG_DATA_HOME/bash-completion</em>,<br>\n<code>$XDG_DATA_HOME</code> &#8594; <em>$HOME/.local/share</em></p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n</dd>\n</dl>\n</div>\n<hr>\n<div class=\"dlist\">\n<dl>\n<dt class=\"hdlist1\"><code>${XDG_DATA_DIRS}/bash-completion/completions</code></dt>\n<dd>\n<p>デフォルト値は</p>\n<div class=\"openblock\">\n<div class=\"content\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>/usr/local/share/bash-completion/completions</code></p>\n</li>\n<li>\n<p><code>/usr/share/bash-completion/completions</code></p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>の2つのディレクトリ。</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">変数のデフォルト値について補足</div>\n<code>$XDG_DATA_DIRS</code> &#8594; <em>/usr/local/share:/usr/share</em><br>\nそれぞれ <em>for</em> 文で登録される。\n</td>\n</tr>\n</table>\n</div>\n</dd>\n</dl>\n</div>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>以上より、上記ディレクトリのいずれかに補完スクリプトを配置すれば読み込まれる。</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\">📖参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/scop/bash-completion\" target=\"_blank\" rel=\"noopener\">scop/bash-completion: Programmable completion functions for bash</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","title":"bash の補完スクリプト（bash-completion）ファイルってどこに配置すればいいの？","created_at":"2021-09-17","tags":["bash","bash-completion","linux","備忘録"],"updated_at":"2021-09-17","author":"秋々すすき","revision":"1.0"}