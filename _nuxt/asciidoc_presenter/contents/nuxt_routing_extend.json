{
  "filename": "nuxt_routing_extend.adoc",
  "rendered": [
    "<div id=\"toc\" class=\"toc\">",
    "<div id=\"toctitle\">目次</div>",
    "<ul class=\"sectlevel1\">",
    "<li><a href=\"#_はじめに\">はじめに🐕</a></li>",
    "<li><a href=\"#_router_extendroutes_プロパティ\"><code>router.extendRoutes</code> プロパティ🛰️</a></li>",
    "<li><a href=\"#_ルーティング拡張の設定例\">ルーティング拡張の設定例🧪</a>",
    "<ul class=\"sectlevel2\">",
    "<li><a href=\"#_ルートを複数設定するとき\">ルートを複数設定するとき</a></li>",
    "<li><a href=\"#_リダイレクトさせたいとき\">リダイレクトさせたいとき</a></li>",
    "<li><a href=\"#_ルートコンポーネントにプロパティを渡す\">ルートコンポーネントにプロパティを渡す</a></li>",
    "<li><a href=\"#_meta_タグを設定したいとき\"><code>meta</code> タグを設定したいとき</a></li>",
    "</ul>",
    "</li>",
    "<li><a href=\"#_おわりに\">おわりに😎</a></li>",
    "<li><a href=\"#_参考\">参考📖</a></li>",
    "</ul>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_はじめに\">はじめに🐕</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p><em>Nuxt</em> では通常、ルーティングはディレクトリ構造から自動的に算出される。<br>",
    "一方で、ディレクトリ構造によらない独自のルーティングを手動で追加したいときもある（リダイレクト処理だけしたいときや<a href=\"https://router.vuejs.org/ja/guide/essentials/redirect-and-alias.html#%E3%82%A8%E3%82%A4%E3%83%AA%E3%82%A2%E3%82%B9\" target=\"_blank\" rel=\"noopener\">エイリアス</a>を利用したいときなど）。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>そのようなルーティングを拡張するための方法として、<code>nuxt.config.js</code> ファイル内で <a href=\"https://ja.nuxtjs.org/docs/2.x/configuration-glossary/configuration-router/#extendroutes\" target=\"_blank\" rel=\"noopener\"><code>router.extendRoutes</code></a> プロパティを使う方法について説明する。</p>",
    "</div>",
    "<table class=\"tableblock frame-all grid-all fit-content\">",
    "<caption class=\"title\">Table 1. 環境</caption>",
    "<colgroup>",
    "<col>",
    "<col>",
    "</colgroup>",
    "<thead>",
    "<tr>",
    "<th class=\"tableblock halign-left valign-top\">App</th>",
    "<th class=\"tableblock halign-left valign-top\">Version</th>",
    "</tr>",
    "</thead>",
    "<tbody>",
    "<tr>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Nuxt.js</p></td>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">2.14.12</p></td>",
    "</tr>",
    "</tbody>",
    "</table>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_router_extendroutes_プロパティ\"><a href=\"https://ja.nuxtjs.org/docs/2.x/configuration-glossary/configuration-router/#extendroutes\" target=\"_blank\" rel=\"noopener\"><code>router.extendRoutes</code></a> プロパティ🛰️</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p><code>nuxt.config.js</code> ファイルの <code>route</code> プロパティにおける <a href=\"https://ja.nuxtjs.org/docs/2.x/configuration-glossary/configuration-router/#extendroutes\" target=\"_blank\" rel=\"noopener\"><code>extendRoutes</code></a> からルーティングを追加できる。<br>",
    "下記は設定の一例。</p>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 1. nuxt.config.js</div>",
    "<div class=\"content\">",
    "<div ",
    "    class=\"listingblock\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight \" ><code class=\"language-js\"",
    "    data-lang=\"js\">import { sortRoutes } from '@nuxt/utils'",
    "",
    "export default {",
    "  router: {",
    "    extendRoutes(routes, resolve) {",
    "      routes.push({",
    "        path: '/blog/page/:id',   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>",
    "        component: resolve(__dirname, 'pages/blog/index.vue'),   <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>",
    "        name: 'blog-page-id',     <i class=\"conum\" data-value=\"3\"></i><b>(3)</b>",
    "      })",
    "",
    "      sortRoutes(routes)  <i class=\"conum\" data-value=\"4\"></i><b>(4)</b>",
    "    },",
    "  },",
    "}</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"colist arabic\">",
    "<table>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>",
    "<td>追加するルートパスを指定。<br>",
    "例では動的ルーティングを追加している。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>",
    "<td>ルートパスに対応するコンポーネントのファイルを指定。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>",
    "<td>（オプション）ルートの識別名となる任意の値。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"4\"></i><b>4</b></td>",
    "<td>（オプション）ルートをソートしている。</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"admonitionblock note\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>",
    "</td>",
    "<td class=\"content\">",
    "要は <a href=\"https://router.vuejs.org/ja/\" target=\"_blank\" rel=\"noopener\"><code>vue-router</code></a> の設定を行っている。スキーマなどの詳細はそちらを参照。",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "<div class=\"admonitionblock tip\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>",
    "</td>",
    "<td class=\"content\">",
    "<div class=\"paragraph\">",
    "<p>上記例では <code>pages/blog/index.vue</code> ファイルを指定しているため、<code>/blog</code> パスと <code>/blog/page/:id</code> パスとも有効かつ同一コンポーネントを利用している。</p>",
    "</div>",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_ルーティング拡張の設定例\">ルーティング拡張の設定例🧪</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p><code>extendsRoutes</code> の設定方法については <a href=\"https://router.vuejs.org/ja/\" target=\"_blank\" rel=\"noopener\">Vue Router</a> のガイドを参考にやればいい。<br>",
    "以下ではそのうちのいくつかをピックアップ……というか個人的なメモ。</p>",
    "</div>",
    "<div class=\"sect2\">",
    "<h3 id=\"_ルートを複数設定するとき\">ルートを複数設定するとき</h3>",
    "<div class=\"paragraph\">",
    "<p><code>routes.push()</code> の引数にルートの設定オブジェクトを複数指定できる。</p>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 2. ルートの設定オブジェクトを複数指定</div>",
    "<div class=\"content\">",
    "<div ",
    "    class=\"listingblock\">",
    "<div class=\"title\">nuxt.config.js</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight \" ><code class=\"language-js\"",
    "    data-lang=\"js\">export default {",
    "  router: {",
    "    extendRoutes(routes, resolve) {",
    "      routes.push(",
    "        {",
    "          // 1つ目のルート設定",
    "        },",
    "        {",
    "          // 2つ目のルート設定",
    "        },",
    "        {",
    "          // ...",
    "        }",
    "      )",
    "    },",
    "  },",
    "}</code></pre>",
    "  </div>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect2\">",
    "<h3 id=\"_リダイレクトさせたいとき\">リダイレクトさせたいとき</h3>",
    "<div class=\"paragraph\">",
    "<p><code>extendRoutes</code> プロパティにて、ある <em>URL</em> でリダイレクトさせたい場合は次のように記述すればいい。</p>",
    "</div>",
    "<div class=\"admonitionblock note\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>",
    "</td>",
    "<td class=\"content\">",
    "<div class=\"title\">参考</div>",
    "<a href=\"https://router.vuejs.org/ja/guide/essentials/redirect-and-alias.html\" target=\"_blank\" rel=\"noopener\">リダイレクトとエイリアス | Vue Router</a>",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 3. /from &#8594; /to へとリダイレクトさせたい場合</div>",
    "<div class=\"content\">",
    "<div ",
    "    class=\"listingblock\">",
    "<div class=\"title\">nuxt.config.js</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight \" ><code class=\"language-js\"",
    "    data-lang=\"js\">export default {",
    "  router: {",
    "    extendRoutes(routes, resolve) {",
    "      routes.push({",
    "        path: '/from',    <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>",
    "        redirect: '/to'   <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>",
    "      })",
    "    },",
    "  },",
    "}</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"colist arabic\">",
    "<table>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>",
    "<td>リダイレクトの対象となる<strong>元の <em>URL</em> パス</strong>を指定。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>",
    "<td><strong>リダイレクト先</strong>の <em>URL</em> パスを指定。</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect2\">",
    "<h3 id=\"_ルートコンポーネントにプロパティを渡す\">ルートコンポーネントにプロパティを渡す</h3>",
    "<div class=\"paragraph\">",
    "<p>ルートコンポーネントに対して <code>props</code> を渡すこともできる。<br>",
    "単体テストをしやすくしたり拡張ルーティングか否かを判定したりするのに便利そう。</p>",
    "</div>",
    "<div class=\"admonitionblock note\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>",
    "</td>",
    "<td class=\"content\">",
    "<div class=\"title\">参考</div>",
    "<a href=\"https://router.vuejs.org/ja/guide/essentials/passing-props.html\" target=\"_blank\" rel=\"noopener\">ルートコンポーネントにプロパティを渡す | Vue Router</a>",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 4. propsを渡す</div>",
    "<div class=\"content\">",
    "<div ",
    "    class=\"listingblock\">",
    "<div class=\"title\">nuxt.config.js</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight \" ><code class=\"language-js\"",
    "    data-lang=\"js\">export default {",
    "  router: {",
    "    extendRoutes(routes, resolve) {",
    "      routes.push({",
    "        path: '/sample/:slug',",
    "        component: resolve(__dirname, 'pages/sample.vue'),",
    "        props: { isExtendRoute: true, userId: 123 }   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>",
    "      })",
    "    },",
    "  },",
    "}</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"colist arabic\">",
    "<table>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>",
    "<td>この例では <code>isExtendRoute</code> プロパティと <code>userId</code> プロパティを渡している。</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"admonitionblock tip\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-tip\" title=\"Tip\" data-md-icon=\"emoji_objects\"></i>",
    "</td>",
    "<td class=\"content\">",
    "この <code>props</code> にはプロパティの値を返す <code>Function</code> オブジェクトを渡すこともできる（<a href=\"https://router.vuejs.org/ja/guide/essentials/passing-props.html#function-%E3%83%A2%E3%83%BC%E3%83%89\" target=\"_blank\" rel=\"noopener\">参考</a>）。",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "<div class=\"sect2\">",
    "<h3 id=\"_meta_タグを設定したいとき\"><code>meta</code> タグを設定したいとき</h3>",
    "<div class=\"paragraph\">",
    "<p><em>HTML</em> のヘッダ情報を表す <code>MetaInfo</code> オブジェクトをルートコンポーネントに渡し、その値を <code>Vue</code> インスタンスの <code>head()</code> メソッドで返すようにすればいい。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>とはいえ <code>.vue</code> ファイル内で設定したほうが素直でよさそうなので、使い所は少ないかも。<br>",
    "特定の <em>URL</em> で <code>canonical</code> タグや <code>noindex</code> タグを付けたいときに使えそう。</p>",
    "</div>",
    "<div class=\"admonitionblock caution\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-caution\" title=\"Caution\" data-md-icon=\"local_fire_department\"></i>",
    "</td>",
    "<td class=\"content\">",
    "<code>meta</code> プロパティが指定できるので直接 <em>HTML</em> の <code>&lt;meta&gt;</code> 要素として設定できそうだが<strong>できない</strong>。<br>",
    "この <code>meta</code> プロパティはあくまで <code>vue-router</code> の<a href=\"https://router.vuejs.org/ja/guide/advanced/meta.html\" target=\"_blank\" rel=\"noopener\">ルートメタフィールド</a>でしかなく、<em>HTML</em> の要素とは無関係。",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 5. metaタグを定義して渡す</div>",
    "<div class=\"content\">",
    "<div ",
    "    class=\"listingblock\">",
    "<div class=\"title\">nuxt.config.js</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight \" ><code class=\"language-js\"",
    "    data-lang=\"js\">export default {",
    "  router: {",
    "    extendRoutes(routes, resolve) {",
    "      routes.push({",
    "        path: '/sample/page/:id',",
    "        component: resolve(__dirname, 'pages/sample.vue'),",
    "",
    "        /** @return {{metaInfo: import('vue-meta').MetaInfo}} */",
    "        props: (route) =&gt; {   <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>",
    "          return {",
    "            metaInfo: {   <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>",
    "              title: `${route.params.id}ページ目`,",
    "              meta: [{ name: 'robots', content: 'noindex' }],   <i class=\"conum\" data-value=\"3\"></i><b>(3)</b>",
    "            },",
    "          }",
    "        },",
    "",
    "        // meta: { ... }   <i class=\"conum\" data-value=\"4\"></i><b>(4)</b>",
    "      })",
    "    },",
    "  },",
    "}</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"colist arabic\">",
    "<table>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>",
    "<td><code>&lt;head&gt;</code> 要素を返す関数を定義。この返り値がルートコンポーネントに <code>props</code> として渡される。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>",
    "<td>対象のプロパティに渡す <code>MetaInfo</code> オブジェクトを定義。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>",
    "<td><code>meta</code> タグの設定。例では <code>noindex</code> メタタグを設定している。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"4\"></i><b>4</b></td>",
    "<td><code>vue-router</code> のルートメタフィールド。<em>HTML</em> の <code>&lt;meta&gt;</code> 要素とは無関係なので今回は使用しない。</td>",
    "</tr>",
    "</table>",
    "</div>",
    "<div ",
    "    class=\"listingblock\">",
    "<div class=\"title\">pages/sample.vue</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight \" ><code class=\"language-ts\"",
    "    data-lang=\"ts\">&lt;script lang=\"ts\"&gt;",
    "import { Component, Prop, Vue } from 'nuxt-property-decorator'",
    "import { MetaInfo } from 'vue-meta'",
    "",
    "@Component",
    "export default class Sample extends Vue {",
    "  @Prop({ required: false }) metaInfo?: MetaInfo  <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>",
    "",
    "  head(): MetaInfo {  <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>",
    "    return this.metaInfo != null",
    "      ? this.metaInfo",
    "      : { title: 'Sample page' }",
    "  }",
    "}",
    "&lt;/script&gt;</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"colist arabic\">",
    "<table>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>",
    "<td><code>&lt;head&gt;</code> 要素を受け取るプロパティ。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>",
    "<td><code>&lt;head&gt;</code> 要素を定義するメソッド。</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_おわりに\">おわりに😎</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p><em>Nuxt</em> はディレクトリ構造からルーティングしてるから「カスタマイズしたいときは <em>hook</em> とか使わないといけないのかなー」と思ってたけど、簡単に独自設定もできる仕組みだった。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>あんまり頻繁に使うものでもないけど、覚えておくとちょっと幸せになれそう。</p>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_参考\">参考📖</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"ulist\">",
    "<ul>",
    "<li>",
    "<p><a href=\"https://ja.nuxtjs.org/docs/2.x/features/file-system-routing\" target=\"_blank\" rel=\"noopener\">ファイルシステムに基づくルーティング - NuxtJS</a></p>",
    "</li>",
    "<li>",
    "<p><a href=\"https://router.vuejs.org/ja/\" target=\"_blank\" rel=\"noopener\">Vue Router</a></p>",
    "</li>",
    "<li>",
    "<p><a href=\"https://ti-tomo-knowledge.hatenablog.com/entry/2020/06/13/213603\" target=\"_blank\" rel=\"noopener\">Nuxtのrouterやmetaを自由にカスタマイズしたい - 親バカエンジニアのナレッジ帳</a></p>",
    "</li>",
    "</ul>",
    "</div>",
    "</div>",
    "</div>"
  ],
  "title": "Nuxtで独自のルーティングを追加・拡張する",
  "created_at": "2021-02-22",
  "tags": [
    "nuxt.js",
    "routing"
  ],
  "updated_at": "2021-02-22",
  "author": "秋々すすき",
  "revision": "1.0"
}