{
  "filename": "git_partial_clone.adoc",
  "rendered": [
    "<div id=\"toc\" class=\"toc\">",
    "<div id=\"toctitle\">目次</div>",
    "<ul class=\"sectlevel1\">",
    "<li><a href=\"#_どう使うかの結論\">💪どう使うかの結論</a></li>",
    "<li><a href=\"#_パーシャルクローン_partial_clone_とは\">🍕パーシャルクローン（ <em>partial clone</em> ）とは</a>",
    "<ul class=\"sectlevel2\">",
    "<li><a href=\"#_ブロブレスクローン\">🌟ブロブレス・クローン</a></li>",
    "<li><a href=\"#_ツリーレスクローン\">ツリーレス・クローン</a></li>",
    "</ul>",
    "</li>",
    "<li><a href=\"#_一部のファイルディレクトリだけをクローンする_sparse_checkout\">🧩一部のファイル/ディレクトリだけをクローンする（ <em>sparse-checkout</em> ）</a>",
    "<ul class=\"sectlevel2\">",
    "<li><a href=\"#_git_sparse_checkout_コマンドについて\"><code>git sparse-checkout</code> コマンドについて</a></li>",
    "</ul>",
    "</li>",
    "<li><a href=\"#_参考\">📖参考</a></li>",
    "</ul>",
    "</div>",
    "<div id=\"preamble\">",
    "<div class=\"sectionbody\">",
    "<table class=\"tableblock frame-all grid-all stretch\">",
    "<caption class=\"title\">Table 1. 環境</caption>",
    "<colgroup>",
    "<col style=\"width: 50%;\">",
    "<col style=\"width: 50%;\">",
    "</colgroup>",
    "<thead>",
    "<tr>",
    "<th class=\"tableblock halign-left valign-top\">App</th>",
    "<th class=\"tableblock halign-left valign-top\">Version</th>",
    "</tr>",
    "</thead>",
    "<tbody>",
    "<tr>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><em>git</em></p></td>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">2.32.0</p></td>",
    "</tr>",
    "</tbody>",
    "</table>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_どう使うかの結論\">💪どう使うかの結論</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"imageblock kroki\">",
    "<div class=\"content\">",
    "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" height=\"373px\" preserveAspectRatio=\"none\" style=\"width:648px;height:373px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 648 373\" width=\"648px\" zoomAndPan=\"magnify\"><defs/><g><polygon fill=\"#F1F1F1\" points=\"265,11.8989,400,11.8989,412,23.8989,400,35.8989,265,35.8989,253,23.8989,265,11.8989\" style=\"stroke:#181818;stroke-width:0.5;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"135\" x=\"265\" y=\"27.707\">リポジトリでgit作業する？</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"20\" x=\"233\" y=\"21.3047\">yes</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"14\" x=\"412\" y=\"21.3047\">no</text><polygon fill=\"#F1F1F1\" points=\"103,45.8989,235,45.8989,247,57.8989,235,69.8989,103,69.8989,91,57.8989,103,45.8989\" style=\"stroke:#181818;stroke-width:0.5;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"132\" x=\"103\" y=\"61.707\">リポジトリが大きすぎる？</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"20\" x=\"71\" y=\"55.3047\">yes</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"14\" x=\"247\" y=\"55.3047\">no</text><rect fill=\"#90EE90\" height=\"33.9688\" rx=\"12.5\" ry=\"12.5\" style=\"stroke:#181818;stroke-width:0.5;\" width=\"140\" x=\"11\" y=\"79.8989\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"120\" x=\"21\" y=\"101.0376\">ブロブレス・クローン</text><rect fill=\"#90EE90\" height=\"33.9688\" rx=\"12.5\" ry=\"12.5\" style=\"stroke:#181818;stroke-width:0.5;\" width=\"104\" x=\"205\" y=\"79.8989\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"84\" x=\"215\" y=\"101.0376\">通常のクローン</text><polygon fill=\"#F1F1F1\" points=\"169,119.8677,181,131.8677,169,143.8677,157,131.8677,169,119.8677\" style=\"stroke:#181818;stroke-width:0.5;\"/><polygon fill=\"#F1F1F1\" points=\"441,45.8989,551,45.8989,563,57.8989,551,69.8989,441,69.8989,429,57.8989,441,45.8989\" style=\"stroke:#181818;stroke-width:0.5;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"110\" x=\"441\" y=\"61.707\">コミット履歴が必要？</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"20\" x=\"409\" y=\"55.3047\">yes</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"14\" x=\"563\" y=\"55.3047\">no</text><rect fill=\"#90EE90\" height=\"33.9688\" rx=\"12.5\" ry=\"12.5\" style=\"stroke:#181818;stroke-width:0.5;\" width=\"140\" x=\"349\" y=\"79.8989\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"120\" x=\"359\" y=\"101.0376\">ツリーレス・クローン</text><rect fill=\"#90EE90\" height=\"33.9688\" rx=\"12.5\" ry=\"12.5\" style=\"stroke:#181818;stroke-width:0.5;\" width=\"128\" x=\"509\" y=\"79.8989\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"108\" x=\"519\" y=\"101.0376\">シャロー・クローン</text><polygon fill=\"#F1F1F1\" points=\"496,119.8677,508,131.8677,496,143.8677,484,131.8677,496,119.8677\" style=\"stroke:#181818;stroke-width:0.5;\"/><polygon fill=\"#F1F1F1\" points=\"332.5,149.8677,344.5,161.8677,332.5,173.8677,320.5,161.8677,332.5,149.8677\" style=\"stroke:#181818;stroke-width:0.5;\"/><rect fill=\"#B0C4DE\" height=\"33.9688\" rx=\"12.5\" ry=\"12.5\" style=\"stroke:#181818;stroke-width:0.5;\" width=\"138\" x=\"263.5\" y=\"242.27\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"118\" x=\"273.5\" y=\"263.4087\">sparse-checkout</text><polygon fill=\"#F1F1F1\" points=\"226,193.8677,439,193.8677,451,205.8677,439,217.8677,226,217.8677,214,205.8677,226,193.8677\" style=\"stroke:#181818;stroke-width:0.5;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"20\" x=\"336.5\" y=\"228.0781\">yes</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"213\" x=\"226\" y=\"209.6758\">一部のファイル/ディレクトリだけが必要？</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"11\" lengthAdjust=\"spacing\" textLength=\"14\" x=\"451\" y=\"203.2734\">no</text><polygon fill=\"#F1F1F1\" points=\"332.5,296.2388,344.5,308.2388,332.5,320.2388,320.5,308.2388,332.5,296.2388\" style=\"stroke:#181818;stroke-width:0.5;\"/><ellipse cx=\"332.5\" cy=\"351.2388\" fill=\"none\" rx=\"11\" ry=\"11\" style=\"stroke:#222222;stroke-width:1.0;\"/><ellipse cx=\"332.5\" cy=\"351.2388\" fill=\"#222222\" rx=\"6\" ry=\"6\" style=\"stroke:#111111;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"91\" x2=\"81\" y1=\"57.8989\" y2=\"57.8989\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"81\" x2=\"81\" y1=\"57.8989\" y2=\"79.8989\"/><polygon fill=\"#181818\" points=\"77,69.8989,81,79.8989,85,69.8989,81,73.8989\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"247\" x2=\"257\" y1=\"57.8989\" y2=\"57.8989\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"257\" x2=\"257\" y1=\"57.8989\" y2=\"79.8989\"/><polygon fill=\"#181818\" points=\"253,69.8989,257,79.8989,261,69.8989,257,73.8989\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"81\" x2=\"81\" y1=\"113.8677\" y2=\"131.8677\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"81\" x2=\"157\" y1=\"131.8677\" y2=\"131.8677\"/><polygon fill=\"#181818\" points=\"147,127.8677,157,131.8677,147,135.8677,151,131.8677\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"257\" x2=\"257\" y1=\"113.8677\" y2=\"131.8677\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"257\" x2=\"181\" y1=\"131.8677\" y2=\"131.8677\"/><polygon fill=\"#181818\" points=\"191,127.8677,181,131.8677,191,135.8677,187,131.8677\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"429\" x2=\"419\" y1=\"57.8989\" y2=\"57.8989\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"419\" x2=\"419\" y1=\"57.8989\" y2=\"79.8989\"/><polygon fill=\"#181818\" points=\"415,69.8989,419,79.8989,423,69.8989,419,73.8989\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"563\" x2=\"573\" y1=\"57.8989\" y2=\"57.8989\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"573\" x2=\"573\" y1=\"57.8989\" y2=\"79.8989\"/><polygon fill=\"#181818\" points=\"569,69.8989,573,79.8989,577,69.8989,573,73.8989\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"419\" x2=\"419\" y1=\"113.8677\" y2=\"131.8677\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"419\" x2=\"484\" y1=\"131.8677\" y2=\"131.8677\"/><polygon fill=\"#181818\" points=\"474,127.8677,484,131.8677,474,135.8677,478,131.8677\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"573\" x2=\"573\" y1=\"113.8677\" y2=\"131.8677\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"573\" x2=\"508\" y1=\"131.8677\" y2=\"131.8677\"/><polygon fill=\"#181818\" points=\"518,127.8677,508,131.8677,518,135.8677,514,131.8677\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"253\" x2=\"169\" y1=\"23.8989\" y2=\"23.8989\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"169\" x2=\"169\" y1=\"23.8989\" y2=\"45.8989\"/><polygon fill=\"#181818\" points=\"165,35.8989,169,45.8989,173,35.8989,169,39.8989\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"412\" x2=\"496\" y1=\"23.8989\" y2=\"23.8989\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"496\" x2=\"496\" y1=\"23.8989\" y2=\"45.8989\"/><polygon fill=\"#181818\" points=\"492,35.8989,496,45.8989,500,35.8989,496,39.8989\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"169\" x2=\"169\" y1=\"143.8677\" y2=\"161.8677\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"169\" x2=\"320.5\" y1=\"161.8677\" y2=\"161.8677\"/><polygon fill=\"#181818\" points=\"310.5,157.8677,320.5,161.8677,310.5,165.8677,314.5,161.8677\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"496\" x2=\"496\" y1=\"143.8677\" y2=\"161.8677\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"496\" x2=\"344.5\" y1=\"161.8677\" y2=\"161.8677\"/><polygon fill=\"#181818\" points=\"354.5,157.8677,344.5,161.8677,354.5,165.8677,350.5,161.8677\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"332.5\" x2=\"332.5\" y1=\"217.8677\" y2=\"242.27\"/><polygon fill=\"#181818\" points=\"328.5,232.27,332.5,242.27,336.5,232.27,332.5,236.27\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"451\" x2=\"463\" y1=\"205.8677\" y2=\"205.8677\"/><polygon fill=\"#181818\" points=\"459,249.2544,463,259.2544,467,249.2544,463,253.2544\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"463\" x2=\"463\" y1=\"205.8677\" y2=\"308.2388\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"463\" x2=\"344.5\" y1=\"308.2388\" y2=\"308.2388\"/><polygon fill=\"#181818\" points=\"354.5,304.2388,344.5,308.2388,354.5,312.2388,350.5,308.2388\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"332.5\" x2=\"332.5\" y1=\"276.2388\" y2=\"296.2388\"/><polygon fill=\"#181818\" points=\"328.5,286.2388,332.5,296.2388,336.5,286.2388,332.5,290.2388\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"332.5\" x2=\"332.5\" y1=\"173.8677\" y2=\"193.8677\"/><polygon fill=\"#181818\" points=\"328.5,183.8677,332.5,193.8677,336.5,183.8677,332.5,187.8677\" style=\"stroke:#181818;stroke-width:1.0;\"/><line style=\"stroke:#181818;stroke-width:1.0;\" x1=\"332.5\" x2=\"332.5\" y1=\"320.2388\" y2=\"340.2388\"/><polygon fill=\"#181818\" points=\"328.5,330.2388,332.5,340.2388,336.5,330.2388,332.5,334.2388\" style=\"stroke:#181818;stroke-width:1.0;\"/><!--SRC=[fP7FIiD048VlUOg0bpGWlUlDYnTlFe6qsoOOaj9i3zwwEug2Vy23Wg9KQMj5JOjKCDA83_DhYZtv2cPNYmXj4Pp3C2pyXk_RSKkc1Re3NKB6e3qrYqxPvSFNYr4xWZY3tFz86ZcJEymthIqMvWmpAtTQy21jTI0ELKeSpGYgMbXpomvVhJBcBzasw1GKwVu0-G8QGFRqImBgs_QopZ4lPARb1xEsZEldQHn3TAU6_Q9RCdwlq0Qo3sg0A3D87zkZw4b9lEsytuY_ic_hNqZ-nGxv36fEOeCv1heR2dqOryTqgtpf1F8QiWMwpuDs8PiQfZUvoXN4yLojBvXrpfYtujLO1XHMDgeXMomuhB0PrBY2-77uXWXvKFa4]--></g></svg>",
    "</div>",
    "<div class=\"title\">Figure 1. クローン方法を選ぶワークフロー</div>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 1. 一般的な使い方をするとき</div>",
    "<div class=\"content\">",
    "<div class=\"paragraph\">",
    "<p>リポジトリで作業をする場合はブロブレス・クローンを利用する。</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git clone --filter=blob:none &lt;URL&gt;</code></pre>",
    "  </div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 2. ビルド生成物だけが必要なとき</div>",
    "<div class=\"content\">",
    "<div class=\"paragraph\">",
    "<p><em>CI</em> でビルドするためだけに使うなど、リポジトリにおいて <em>git</em> 操作をほぼ行わない場合はツリーレス・クローンまたはシャロー・クローンを利用する。</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">コミット履歴は参照したいならツリーレス・クローン</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git clone --filter=tree:0 &lt;URL&gt;</code></pre>",
    "  </div>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">コミット履歴も不要ならばシャロー・クローン</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git clone --depth=1 &lt;URL&gt;</code></pre>",
    "  </div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 3. 一部のファイル/ディレクトリだけ必要なとき</div>",
    "<div class=\"content\">",
    "<div class=\"paragraph\">",
    "<p><em>sparse-checkout</em> 機能を使う。<br>",
    "パーシャルクローンと組み合わせると更に効果的。</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git clone --filter=blob:none --sparse &lt;URL&gt;",
    "cd &lt;REPOSITORY&gt;",
    "git sparse-checkout init --cone",
    "git sparse-checkout set &lt;PATTERN1&gt; [&lt;PATTERN2&gt; ...]</code></pre>",
    "  </div>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_パーシャルクローン_partial_clone_とは\">🍕パーシャルクローン（ <em>partial clone</em> ）とは</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p>指定されたコミットの範囲内でダウンロードする <em>blob</em> オブジェクト<sup class=\"footnote\">[<a id=\"_footnoteref_1\" class=\"footnote\" href=\"#_footnotedef_1\" title=\"View footnote.\">1</a>]</sup>や <em>tree</em> オブジェクト<sup class=\"footnote\">[<a id=\"_footnoteref_2\" class=\"footnote\" href=\"#_footnotedef_2\" title=\"View footnote.\">2</a>]</sup>の数を制限してクローンする機能のこと。<br>",
    "巨大なリポジトリから必要なものだけをクローンすることで、ダウンロード時間やディスク使用容量を削減するために使われる。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>パーシャルクローンは <code>git clone</code> コマンドにおいて <code>--filter</code> オプションを指定することで有効化される。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p><em>GitHub</em> から利用できるパーシャルクローンは <em>ブロブレス・クローン</em> と <em>ツリーレス・クローン</em> の2種類がある。</p>",
    "</div>",
    "<div class=\"sect2\">",
    "<h3 id=\"_ブロブレスクローン\">🌟ブロブレス・クローン</h3>",
    "<div class=\"paragraph\">",
    "<p><code>git clone</code> 実行時にすべてのコミット履歴と <em>tree</em> オブジェクトはダウンロードされるが、各 <em>blob</em> オブジェクトはそれぞれが必要となった時にダウンロードされる<sup class=\"footnote\" id=\"_footnote_cloned\">[<a id=\"_footnoteref_3\" class=\"footnote\" href=\"#_footnotedef_3\" title=\"View footnote.\">3</a>]</sup>。<br>",
    "このブロブレス・クローンは汎用的に使えるパーシャルクローンであり、一般的に使われる手法である。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>リポジトリでの作業において、<em>blob</em> オブジェクトを必要とするコマンドは使用頻度が比較的低い。<br>",
    "そのため、ブロブレス・クローンは通常のクローンと同じような感覚で使える。</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">ブロブレス・クローンの実行</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git clone --filter=blob:none &lt;URL&gt;</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"admonitionblock caution\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-caution\" title=\"Caution\" data-md-icon=\"local_fire_department\"></i>",
    "</td>",
    "<td class=\"content\">",
    "<div class=\"title\">blobオブジェクトのダウンロードが行われるコマンド</div>",
    "<div class=\"paragraph\">",
    "<p><code>git checkout</code> や <code>git pull</code>、 <code>git blame</code> など。<br>",
    "ファイル内容を利用するコマンドが該当する。</p>",
    "</div>",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "<div class=\"sect2\">",
    "<h3 id=\"_ツリーレスクローン\">ツリーレス・クローン</h3>",
    "<div class=\"paragraph\">",
    "<p><code>git clone</code> 実行時にはすべてのコミット履歴のみがダウンロードされ、<em>tree</em> オブジェクトと <em>blob</em> オブジェクトはそれぞれが必要となった時にダウンロードされる<sup class=\"footnoteref\">[<a class=\"footnote\" href=\"#_footnotedef_3\" title=\"View footnote.\">3</a>]</sup>。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>利用方法はシャロー・クローンと似たような感じになり、使い所が限られる。<br>",
    "（<em>tree</em> オブジェクトを必要とする <em>git</em> コマンドが意外とあるみたい）</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">ツリーレス・クローンの実行</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git clone --filter=tree:0 &lt;URL&gt;</code></pre>",
    "  </div>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_一部のファイルディレクトリだけをクローンする_sparse_checkout\">🧩一部のファイル/ディレクトリだけをクローンする（ <a href=\"https://git-scm.com/docs/git-sparse-checkout\" target=\"_blank\" rel=\"noopener\"><em>sparse-checkout</em></a> ）</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p><em>sparse-checkout</em> 機能を利用することで、一部のファイルまたはディレクトリだけに制限してクローンすることができる。<br>",
    "この <em>sparse-checkout</em> 機能は <code>git sparse-checkout</code> コマンドから操作する。</p>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>例として <a href=\"https://github.com/derrickstolee/sparse-checkout-example\" target=\"_blank\" rel=\"noopener\"><em>Sparse-Checkout Example Repo</em></a> リポジトリを対象にすると次のようになる。</p>",
    "</div>",
    "<div class=\"exampleblock\">",
    "<div class=\"title\">Example 4. 一部のファイル/ディレクトリだけをクローンする例</div>",
    "<div class=\"content\">",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">パーシャルクローンと組み合わせ</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"5,9,11\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git clone \\",
    "    --filter=blob:none \\    <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>",
    "    --sparse \\              <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>",
    "    https://github.com/derrickstolee/sparse-checkout-example",
    "",
    "cd ./sparse-checkout-example",
    "git sparse-checkout init --cone         <i class=\"conum\" data-value=\"3\"></i><b>(3)</b>",
    "git sparse-checkout set web/browser     <i class=\"conum\" data-value=\"4\"></i><b>(4)</b>",
    "",
    "ls -AF",
    "bootstrap.sh  .git/  LICENSE.md  README.md  web/</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"colist arabic\">",
    "<table>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>",
    "<td>ブロブレス・クローンとして実行<sup class=\"footnote\">[<a id=\"_footnoteref_4\" class=\"footnote\" href=\"#_footnotedef_4\" title=\"View footnote.\">4</a>]</sup>。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>",
    "<td>リポジトリのルート直下にあるファイルだけをダウンロードするオプション。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>",
    "<td><em>sparse-checkout</em> 機能の有効化。</td>",
    "</tr>",
    "<tr>",
    "<td><i class=\"conum\" data-value=\"4\"></i><b>4</b></td>",
    "<td>ダウンロードしたいファイル/ディレクトリのパスをパターンで新規指定。<br>",
    "パターンを追加する場合は <code>add</code> サブコマンドを使う。</td>",
    "</tr>",
    "</table>",
    "</div>",
    "<div class=\"admonitionblock note\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-note\" title=\"Note\" data-md-icon=\"info\"></i>",
    "</td>",
    "<td class=\"content\">",
    "<em>git v2.27.0</em> 以降では <code>--no-checkout</code> オプションと <code>git sparse-checkout</code> の組み合わせはバグがあったため機能しない。<br>",
    "ただし v2.32.0 では修正されて動作するっぽい。",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect2\">",
    "<h3 id=\"_git_sparse_checkout_コマンドについて\"><code>git sparse-checkout</code> コマンドについて</h3>",
    "<div class=\"admonitionblock caution\">",
    "<table>",
    "<tr>",
    "<td class=\"icon\">",
    "<i class=\"fa icon-caution\" title=\"Caution\" data-md-icon=\"local_fire_department\"></i>",
    "</td>",
    "<td class=\"content\">",
    "<em>git v2.32.0</em> でもまだ実験的なコマンドのため、動作やサブコマンドが変更される可能性がある。",
    "</td>",
    "</tr>",
    "</table>",
    "</div>",
    "<div class=\"dlist\">",
    "<dl>",
    "<dt class=\"hdlist1\"><em>sparse-checkout</em> 機能の有効化</dt>",
    "<dd>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git sparse-checkout init --cone</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"ulist\">",
    "<ul>",
    "<li>",
    "<p>パフォーマンス改善のため、 <code>--cone</code> オプションが一般的に付けられる（詳細は <a href=\"https://git-scm.com/docs/git-sparse-checkout#_cone_pattern_set\" target=\"_blank\" rel=\"noopener\">CONE PATTERN SET</a> を参照）。</p>",
    "</li>",
    "</ul>",
    "</div>",
    "</dd>",
    "<dt class=\"hdlist1\">必要なパスのパターンを登録</dt>",
    "<dd>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"2-10\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git sparse-checkout set &lt;PATTERN1&gt; [&lt;PATTERN2&gt; ...]",
    "git sparse-checkout add &lt;PATTERN1&gt; [&lt;PATTERN2&gt; ...]</code></pre>",
    "  </div>",
    "</div>",
    "<table class=\"tableblock frame-all grid-all fit-content\">",
    "<colgroup>",
    "<col>",
    "<col>",
    "</colgroup>",
    "<tbody>",
    "<tr>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>set</code></p></td>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">指定したパターンで登録リストを新規作成。<br>",
    "既存のリストは上書きされる。</p></td>",
    "</tr>",
    "<tr>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>add</code></p></td>",
    "<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">登録リストに指定したパターンを追加登録。</p></td>",
    "</tr>",
    "</tbody>",
    "</table>",
    "<div class=\"ulist\">",
    "<ul>",
    "<li>",
    "<p>指定するパターンの書式は <code>.gitignore</code> と同様。</p>",
    "</li>",
    "</ul>",
    "</div>",
    "</dd>",
    "<dt class=\"hdlist1\">登録されているパターンの一覧</dt>",
    "<dd>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"2-10\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git sparse-checkout list</code></pre>",
    "  </div>",
    "</div>",
    "</dd>",
    "<dt class=\"hdlist1\"><em>sparse-checkout</em> 機能を再適用</dt>",
    "<dd>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"2-10\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git sparse-checkout reapply</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"ulist\">",
    "<ul>",
    "<li>",
    "<p><code>git merge</code> や <code>git rebase</code> でパスを実体化した場合に使ったりする。</p>",
    "</li>",
    "</ul>",
    "</div>",
    "</dd>",
    "<dt class=\"hdlist1\"><em>sparse-checkout</em> 機能を無効化</dt>",
    "<dd>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"2-10\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git sparse-checkout disable</code></pre>",
    "  </div>",
    "</div>",
    "</dd>",
    "</dl>",
    "</div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_参考\">📖参考</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"ulist\">",
    "<div class=\"title\">Partial Clone</div>",
    "<ul>",
    "<li>",
    "<p><a href=\"https://git-scm.com/docs/partial-clone\" target=\"_blank\" rel=\"noopener\">Git - partial-clone Documentation</a></p>",
    "</li>",
    "<li>",
    "<p><a href=\"https://github.blog/jp/2021-01-13-get-up-to-speed-with-partial-clone-and-shallow-clone/\" target=\"_blank\" rel=\"noopener\">パーシャルクローンとシャロークローンを活用しよう - GitHubブログ</a></p>",
    "</li>",
    "</ul>",
    "</div>",
    "<div class=\"ulist\">",
    "<div class=\"title\">sparse-checkout</div>",
    "<ul>",
    "<li>",
    "<p><a href=\"https://git-scm.com/docs/git-sparse-checkout\" target=\"_blank\" rel=\"noopener\">git-sparse-checkout Documentation</a></p>",
    "</li>",
    "<li>",
    "<p><a href=\"https://github.blog/2020-01-17-bring-your-monorepo-down-to-size-with-sparse-checkout/\" target=\"_blank\" rel=\"noopener\">Bring your monorepo down to size with sparse-checkout | The GitHub Blog</a></p>",
    "</li>",
    "<li>",
    "<p><a href=\"https://iucstscui.hatenablog.com/entry/2020/08/29/080322\" target=\"_blank\" rel=\"noopener\">git2.27以降にgit sparse-checkoutを使う場合はno-checkoutではなくsparseを使おう - はんなりと、ゆるやかに</a></p>",
    "</li>",
    "</ul>",
    "</div>",
    "</div>",
    "</div>",
    "<div id=\"footnotes\">",
    "<hr>",
    "<div class=\"footnote\" id=\"_footnotedef_1\">",
    "<a href=\"#_footnoteref_1\">1</a>. <em>git</em> 内部で使用されているオブジェクトタイプ。リポジトリ内の各ファイルの中身が保存されている。",
    "</div>",
    "<div class=\"footnote\" id=\"_footnotedef_2\">",
    "<a href=\"#_footnoteref_2\">2</a>. ディレクトリのようなもの。各オブジェクトの階層情報が保存されている。",
    "</div>",
    "<div class=\"footnote\" id=\"_footnotedef_3\">",
    "<a href=\"#_footnoteref_3\">3</a>. <code>HEAD</code> コミットだけは全てのデータがダウンロードされている。",
    "</div>",
    "<div class=\"footnote\" id=\"_footnotedef_4\">",
    "<a href=\"#_footnoteref_4\">4</a>. 通常のクローンと比較して、この例では <em>172MB</em> &#8594; <em>504KB</em> へとサイズ削減できた。",
    "</div>",
    "</div>"
  ],
  "title": "巨大なリポジトリをクローンするときに便利なパーシャルクローンとsparse-checkout",
  "created_at": "2021-07-22",
  "tags": [
    "git",
    "partial-clone"
  ],
  "updated_at": "2021-07-22",
  "author": "秋々すすき",
  "revision": "1.0"
}