{
  "filename": "fatal_cannot_lock_ref_HEAD_when_git_rebase.adoc",
  "rendered": [
    "<div id=\"toc\" class=\"toc\">",
    "<div id=\"toctitle\">目次</div>",
    "<ul class=\"sectlevel1\">",
    "<li><a href=\"#_問題\">💣 問題</a></li>",
    "<li><a href=\"#_原因たぶん\">🔍 原因（たぶん）</a></li>",
    "<li><a href=\"#_解決\">💪 解決</a></li>",
    "</ul>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_問題\">💣 問題</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p><em>fixup</em> や <em>squash</em> なコミットをまとめようと <code>git rebase</code> したときにエラー発生。</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">Error!</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"2-4\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">git rebase -i –autosquash develop",
    "",
    "fatal: cannot lock ref 'HEAD': is at 5b41137 but expected c3b1c26",
    "Could not apply c3b1c26… COMMIT_MESSAGE</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>ブランチのツリーは次のような状態。</p>",
    "</div>",
    "<div class=\"imageblock\">",
    "<div class=\"content\">",
    "<img src=\"/_images/codepen/example.png\" alt=\"Git Graph\">",
    "</div>",
    "<div class=\"title\">Figure 1. ブランチツリー例</div>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_原因たぶん\">🔍 原因（たぶん）</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p>なんか <code>.git/refs/heads/</code> 直下に空ディレクトリが生成されている。<br>",
    "（例では <code>akiakishitai/</code> ）</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">.git/refs/heads/ 以下を探索</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"2-3, 5\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">ls .git/refs/heads/",
    "akiakishitai/  master",
    "",
    "ls -Al .git/refs/heads/akiakishitai/",
    "total 0</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>この空ディレクトリが <code>HEAD</code> を参照するときに使われて、でも空なので代わりに <code>master</code> の方が使われる、のかなぁ？</p>",
    "</div>",
    "</div>",
    "</div>",
    "<div class=\"sect1\">",
    "<h2 id=\"_解決\">💪 解決</h2>",
    "<div class=\"sectionbody\">",
    "<div class=\"paragraph\">",
    "<p>とりあえず上記の不必要な空ディレクトリを削除してから再度 <code>git rebase</code> 実行。</p>",
    "</div>",
    "<div ",
    "    class=\"listingblock no-line-numbers command-line\">",
    "<div class=\"title\">空ディレクトリ削除で成功</div>",
    "  <div class=\"content\">",
    "  <pre class=\"highlight command-line\" data-user=\"user\"",
    "    data-host=\"local\"",
    "    data-output=\"3-7\"",
    "    ><code class=\"language-bash\"",
    "    data-lang=\"bash\">rmdir .git/refs/heads/akiakishitai/",
    "git rebase -i –autosquash develop",
    "",
    "[detached HEAD 15204bc] ...",
    "...",
    " 3 files changed, 24 insertions(+), 7deletions(-)",
    "Successfully rebased and updated refs/heads/akiakishitai/issue123.</code></pre>",
    "  </div>",
    "</div>",
    "<div class=\"paragraph\">",
    "<p>無事成功！👏</p>",
    "</div>",
    "</div>",
    "</div>"
  ],
  "title": "git rebase 時に \"cannot lock ref 'HEAD'\" エラー",
  "created_at": "2020-08-01",
  "tags": [
    "git"
  ],
  "updated_at": "2020-11-19",
  "author": "秋々すすき",
  "revision": "1.2"
}